function FastClick(t){"use strict";var e,n=this;if(this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=10,this.layer=t,!t||!t.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return FastClick.prototype.onClick.apply(n,arguments)},this.onMouse=function(){return FastClick.prototype.onMouse.apply(n,arguments)},this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(n,arguments)},this.onTouchMove=function(){return FastClick.prototype.onTouchMove.apply(n,arguments)},this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(n,arguments)},this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(n,arguments)},FastClick.notNeeded(t)||(this.deviceIsAndroid&&(t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0)),t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(t.removeEventListener=function(e,n,i){var r=Node.prototype.removeEventListener;"click"===e?r.call(t,e,n.hijacked||n,i):r.call(t,e,n,i)},t.addEventListener=function(e,n,i){var r=Node.prototype.addEventListener;"click"===e?r.call(t,e,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),i):r.call(t,e,n,i)}),"function"==typeof t.onclick&&(e=t.onclick,t.addEventListener("click",function(t){e(t)},!1),t.onclick=null))}FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),FastClick.prototype.needsClick=function(t){"use strict";switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(this.deviceIsIOS&&"file"===t.type||t.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(t.className)},FastClick.prototype.needsFocus=function(t){"use strict";switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!this.deviceIsAndroid;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},FastClick.prototype.sendClick=function(t,e){"use strict";var n,i;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),i=e.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(t),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,t.dispatchEvent(n)},FastClick.prototype.determineEventType=function(t){"use strict";return this.deviceIsAndroid&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(t){"use strict";var e;this.deviceIsIOS&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},FastClick.prototype.updateScrollParent=function(t){"use strict";var e,n;if(e=t.fastClickScrollParent,!e||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(t){"use strict";return t.nodeType===Node.TEXT_NODE?t.parentNode:t},FastClick.prototype.onTouchStart=function(t){"use strict";var e,n,i;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),n=t.targetTouches[0],this.deviceIsIOS){if(i=window.getSelection(),i.rangeCount&&!i.isCollapsed)return!0;if(!this.deviceIsIOS4){if(n.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=n.pageX,this.touchStartY=n.pageY,200>t.timeStamp-this.lastClickTime&&t.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(t){"use strict";var e=t.changedTouches[0],n=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>n||Math.abs(e.pageY-this.touchStartY)>n?!0:!1},FastClick.prototype.onTouchMove=function(t){"use strict";return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},FastClick.prototype.findControl=function(t){"use strict";return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(t){"use strict";var e,n,i,r,s,o=this.targetElement;if(!this.trackingClick)return!0;if(200>t.timeStamp-this.lastClickTime)return this.cancelNextClick=!0,!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,this.deviceIsIOSWithBadTarget&&(s=t.changedTouches[0],o=document.elementFromPoint(s.pageX-window.pageXOffset,s.pageY-window.pageYOffset)||o,o.fastClickScrollParent=this.targetElement.fastClickScrollParent),i=o.tagName.toLowerCase(),"label"===i){if(e=this.findControl(o)){if(this.focus(o),this.deviceIsAndroid)return!1;o=e}}else if(this.needsFocus(o))return t.timeStamp-n>100||this.deviceIsIOS&&window.top!==window&&"input"===i?(this.targetElement=null,!1):(this.focus(o),this.deviceIsIOS4&&"select"===i||(this.targetElement=null,t.preventDefault()),!1);return this.deviceIsIOS&&!this.deviceIsIOS4&&(r=o.fastClickScrollParent,r&&r.fastClickLastScrollTop!==r.scrollTop)?!0:(this.needsClick(o)||(t.preventDefault(),this.sendClick(o,t)),!1)},FastClick.prototype.onTouchCancel=function(){"use strict";this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(t){"use strict";return this.targetElement?t.forwardedTouchEvent?!0:t.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1):!0:!0:!0},FastClick.prototype.onClick=function(t){"use strict";var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail?!0:(e=this.onMouse(t),e||(this.targetElement=null),e)},FastClick.prototype.destroy=function(){"use strict";var t=this.layer;this.deviceIsAndroid&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(t){"use strict";var e;if(window.ontouchstart===void 0)return!0;if(/Chrome\/[0-9]+/.test(navigator.userAgent)){if(!FastClick.prototype.deviceIsAndroid)return!0;if(e=document.querySelector("meta[name=viewport]"),e&&-1!==e.content.indexOf("user-scalable=no"))return!0}return"none"===t.style.msTouchAction?!0:!1},FastClick.attach=function(t){"use strict";return new FastClick(t)},"undefined"!=typeof define&&define.amd?define(function(){"use strict";return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,function(t){String.prototype.trim===t&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.reduce===t&&(Array.prototype.reduce=function(e){if(void 0===this||null===this)throw new TypeError;var n,i=Object(this),r=i.length>>>0,s=0;if("function"!=typeof e)throw new TypeError;if(0==r&&1==arguments.length)throw new TypeError;if(arguments.length>=2)n=arguments[1];else for(;;){if(s in i){n=i[s++];break}if(++s>=r)throw new TypeError}for(;r>s;)s in i&&(n=e.call(t,n,i[s],s,i)),s++;return n})}();var Zepto=function(){function t(t){return null==t?t+"":X[Z.call(t)]||"object"}function e(e){return"function"==t(e)}function n(t){return null!=t&&t==t.window}function i(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function r(e){return"object"==t(e)}function s(t){return r(t)&&!n(t)&&t.__proto__==Object.prototype}function o(t){return t instanceof Array}function a(t){return"number"==typeof t.length}function c(t){return W.call(t,function(t){return null!=t})}function l(t){return t.length>0?C.fn.concat.apply([],t):t}function u(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function h(t){return t in P?P[t]:P[t]=RegExp("(^|\\s)"+t+"(\\s|$)")}function d(t,e){return"number"!=typeof e||O[u(t)]?e:e+"px"}function f(t){var e,n;return j[t]||(e=A.createElement(t),A.body.appendChild(e),n=N(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),j[t]=n),j[t]}function p(t){return"children"in t?M.call(t.children):C.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function _(t,e,n){for(x in e)n&&(s(e[x])||o(e[x]))?(s(e[x])&&!s(t[x])&&(t[x]={}),o(e[x])&&!o(t[x])&&(t[x]=[]),_(t[x],e[x],n)):e[x]!==k&&(t[x]=e[x])}function m(t,e){return e===k?C(t):C(t).filter(e)}function v(t,n,i,r){return e(n)?n.call(t,i,r):n}function g(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function y(t,e){var n=t.className,i=n&&n.baseVal!==k;return e===k?i?n.baseVal:n:(i?n.baseVal=e:t.className=e,void 0)}function w(t){var e;try{return t?"true"==t||("false"==t?!1:"null"==t?null:isNaN(e=Number(t))?/^[\[\{]/.test(t)?C.parseJSON(t):t:e):t}catch(n){return t}}function b(t,e){e(t);for(var n in t.childNodes)b(t.childNodes[n],e)}var k,x,C,T,E,$,S=[],M=S.slice,W=S.filter,A=window.document,j={},P={},N=A.defaultView.getComputedStyle,O={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},L=/^\s*<(\w+|!)[^>]*>/,R=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,I=/^(?:body|html)$/i,F=["val","css","html","text","data","width","height","offset"],B=["after","prepend","before","append"],D=A.createElement("table"),V=A.createElement("tr"),H={tr:A.createElement("tbody"),tbody:D,thead:D,tfoot:D,td:V,th:V,"*":A.createElement("div")},z=/complete|loaded|interactive/,U=/^\.([\w-]+)$/,q=/^#([\w-]*)$/,J=/^[\w-]+$/,X={},Z=X.toString,Y={},G=A.createElement("div");return Y.matches=function(t,e){if(!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var i,r=t.parentNode,s=!r;return s&&(r=G).appendChild(t),i=~Y.qsa(r,e).indexOf(t),s&&G.removeChild(t),i},E=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},$=function(t){return W.call(t,function(e,n){return t.indexOf(e)==n})},Y.fragment=function(t,e,n){t.replace&&(t=t.replace(R,"<$1></$2>")),e===k&&(e=L.test(t)&&RegExp.$1),e in H||(e="*");var i,r,o=H[e];return o.innerHTML=""+t,r=C.each(M.call(o.childNodes),function(){o.removeChild(this)}),s(n)&&(i=C(r),C.each(n,function(t,e){F.indexOf(t)>-1?i[t](e):i.attr(t,e)})),r},Y.Z=function(t,e){return t=t||[],t.__proto__=C.fn,t.selector=e||"",t},Y.isZ=function(t){return t instanceof Y.Z},Y.init=function(t,n){if(!t)return Y.Z();if(e(t))return C(A).ready(t);if(Y.isZ(t))return t;var i;if(o(t))i=c(t);else if(r(t))i=[s(t)?C.extend({},t):t],t=null;else if(L.test(t))i=Y.fragment(t.trim(),RegExp.$1,n),t=null;else{if(n!==k)return C(n).find(t);i=Y.qsa(A,t)}return Y.Z(i,t)},C=function(t,e){return Y.init(t,e)},C.extend=function(t){var e,n=M.call(arguments,1);return"boolean"==typeof t&&(e=t,t=n.shift()),n.forEach(function(n){_(t,n,e)}),t},Y.qsa=function(t,e){var n;return i(t)&&q.test(e)?(n=t.getElementById(RegExp.$1))?[n]:[]:1!==t.nodeType&&9!==t.nodeType?[]:M.call(U.test(e)?t.getElementsByClassName(RegExp.$1):J.test(e)?t.getElementsByTagName(e):t.querySelectorAll(e))},C.contains=function(t,e){return t!==e&&t.contains(e)},C.type=t,C.isFunction=e,C.isWindow=n,C.isArray=o,C.isPlainObject=s,C.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},C.inArray=function(t,e,n){return S.indexOf.call(e,t,n)},C.camelCase=E,C.trim=function(t){return t.trim()},C.uuid=0,C.support={},C.expr={},C.map=function(t,e){var n,i,r,s=[];if(a(t))for(i=0;t.length>i;i++)n=e(t[i],i),null!=n&&s.push(n);else for(r in t)n=e(t[r],r),null!=n&&s.push(n);return l(s)},C.each=function(t,e){var n,i;if(a(t)){for(n=0;t.length>n;n++)if(e.call(t[n],n,t[n])===!1)return t}else for(i in t)if(e.call(t[i],i,t[i])===!1)return t;return t},C.grep=function(t,e){return W.call(t,e)},window.JSON&&(C.parseJSON=JSON.parse),C.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){X["[object "+e+"]"]=e.toLowerCase()}),C.fn={forEach:S.forEach,reduce:S.reduce,push:S.push,sort:S.sort,indexOf:S.indexOf,concat:S.concat,map:function(t){return C(C.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return C(M.apply(this,arguments))},ready:function(t){return z.test(A.readyState)?t(C):A.addEventListener("DOMContentLoaded",function(){t(C)},!1),this},get:function(t){return t===k?M.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return S.every.call(this,function(e,n){return t.call(e,n,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):C(W.call(this,function(e){return Y.matches(e,t)}))},add:function(t,e){return C($(this.concat(C(t,e))))},is:function(t){return this.length>0&&Y.matches(this[0],t)},not:function(t){var n=[];if(e(t)&&t.call!==k)this.each(function(e){t.call(this,e)||n.push(this)});else{var i="string"==typeof t?this.filter(t):a(t)&&e(t.item)?M.call(t):C(t);this.forEach(function(t){0>i.indexOf(t)&&n.push(t)})}return C(n)},has:function(t){return this.filter(function(){return r(t)?C.contains(this,t):C(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!r(t)?t:C(t)},last:function(){var t=this[this.length-1];return t&&!r(t)?t:C(t)},find:function(t){var e,n=this;return e="object"==typeof t?C(t).filter(function(){var t=this;return S.some.call(n,function(e){return C.contains(e,t)})}):1==this.length?C(Y.qsa(this[0],t)):this.map(function(){return Y.qsa(this,t)})},closest:function(t,e){var n=this[0],r=!1;for("object"==typeof t&&(r=C(t));n&&!(r?r.indexOf(n)>=0:Y.matches(n,t));)n=n!==e&&!i(n)&&n.parentNode;return C(n)},parents:function(t){for(var e=[],n=this;n.length>0;)n=C.map(n,function(t){return(t=t.parentNode)&&!i(t)&&0>e.indexOf(t)?(e.push(t),t):void 0});return m(e,t)},parent:function(t){return m($(this.pluck("parentNode")),t)},children:function(t){return m(this.map(function(){return p(this)}),t)},contents:function(){return this.map(function(){return M.call(this.childNodes)})},siblings:function(t){return m(this.map(function(t,e){return W.call(p(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return C.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null),"none"==N(this,"").getPropertyValue("display")&&(this.style.display=f(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var n=e(t);if(this[0]&&!n)var i=C(t).get(0),r=i.parentNode||this.length>1;return this.each(function(e){C(this).wrapAll(n?t.call(this,e):r?i.cloneNode(!0):i)})},wrapAll:function(t){if(this[0]){C(this[0]).before(t=C(t));for(var e;(e=t.children()).length;)t=e.first();C(t).append(this)}return this},wrapInner:function(t){var n=e(t);return this.each(function(e){var i=C(this),r=i.contents(),s=n?t.call(this,e):t;r.length?r.wrapAll(s):i.append(s)})},unwrap:function(){return this.parent().each(function(){C(this).replaceWith(C(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=C(this);(t===k?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return C(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return C(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return t===k?this.length>0?this[0].innerHTML:null:this.each(function(e){var n=this.innerHTML;C(this).empty().append(v(this,t,e,n))})},text:function(t){return t===k?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t})},attr:function(t,e){var n;return"string"==typeof t&&e===k?0==this.length||1!==this[0].nodeType?k:"value"==t&&"INPUT"==this[0].nodeName?this.val():!(n=this[0].getAttribute(t))&&t in this[0]?this[0][t]:n:this.each(function(n){if(1===this.nodeType)if(r(t))for(x in t)g(this,x,t[x]);else g(this,t,v(this,e,n,this.getAttribute(t)))})},removeAttr:function(t){return this.each(function(){1===this.nodeType&&g(this,t)})},prop:function(t,e){return e===k?this[0]&&this[0][t]:this.each(function(n){this[t]=v(this,e,n,this[t])})},data:function(t,e){var n=this.attr("data-"+u(t),e);return null!==n?w(n):k},val:function(t){return t===k?this[0]&&(this[0].multiple?C(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(e){this.value=v(this,t,e,this.value)})},offset:function(t){if(t)return this.each(function(e){var n=C(this),i=v(this,t,e,n.offset()),r=n.offsetParent().offset(),s={top:i.top-r.top,left:i.left-r.left};"static"==n.css("position")&&(s.position="relative"),n.css(s)});if(0==this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,n){if(2>arguments.length&&"string"==typeof e)return this[0]&&(this[0].style[E(e)]||N(this[0],"").getPropertyValue(e));var i="";if("string"==t(e))n||0===n?i=u(e)+":"+d(e,n):this.each(function(){this.style.removeProperty(u(e))});else for(x in e)e[x]||0===e[x]?i+=u(x)+":"+d(x,e[x])+";":this.each(function(){this.style.removeProperty(u(x))});return this.each(function(){this.style.cssText+=";"+i})},index:function(t){return t?this.indexOf(C(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return S.some.call(this,function(t){return this.test(y(t))},h(t))},addClass:function(t){return this.each(function(e){T=[];var n=y(this),i=v(this,t,e,n);i.split(/\s+/g).forEach(function(t){C(this).hasClass(t)||T.push(t)},this),T.length&&y(this,n+(n?" ":"")+T.join(" "))})},removeClass:function(t){return this.each(function(e){return t===k?y(this,""):(T=y(this),v(this,t,e,T).split(/\s+/g).forEach(function(t){T=T.replace(h(t)," ")}),y(this,T.trim()),void 0)})},toggleClass:function(t,e){return this.each(function(n){var i=C(this),r=v(this,t,n,y(this));r.split(/\s+/g).forEach(function(t){(e===k?!i.hasClass(t):e)?i.addClass(t):i.removeClass(t)})})},scrollTop:function(){return this.length?"scrollTop"in this[0]?this[0].scrollTop:this[0].scrollY:void 0},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),n=this.offset(),i=I.test(e[0].nodeName)?{top:0,left:0}:e.offset();return n.top-=parseFloat(C(t).css("margin-top"))||0,n.left-=parseFloat(C(t).css("margin-left"))||0,i.top+=parseFloat(C(e[0]).css("border-top-width"))||0,i.left+=parseFloat(C(e[0]).css("border-left-width"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||A.body;t&&!I.test(t.nodeName)&&"static"==C(t).css("position");)t=t.offsetParent;return t})}},C.fn.detach=C.fn.remove,["width","height"].forEach(function(t){C.fn[t]=function(e){var r,s=this[0],o=t.replace(/./,function(t){return t[0].toUpperCase()});return e===k?n(s)?s["inner"+o]:i(s)?s.documentElement["offset"+o]:(r=this.offset())&&r[t]:this.each(function(n){s=C(this),s.css(t,v(this,e,n,s[t]()))})}}),B.forEach(function(e,n){var i=n%2;C.fn[e]=function(){var e,r,s=C.map(arguments,function(n){return e=t(n),"object"==e||"array"==e||null==n?n:Y.fragment(n)}),o=this.length>1;return 1>s.length?this:this.each(function(t,e){r=i?e:e.parentNode,e=0==n?e.nextSibling:1==n?e.firstChild:2==n?e:null,s.forEach(function(t){if(o)t=t.cloneNode(!0);else if(!r)return C(t).remove();b(r.insertBefore(t,e),function(t){null!=t.nodeName&&"SCRIPT"===t.nodeName.toUpperCase()&&(!t.type||"text/javascript"===t.type)&&!t.src&&window.eval.call(window,t.innerHTML)})})})},C.fn[i?e+"To":"insert"+(n?"Before":"After")]=function(t){return C(t)[e](this),this}}),Y.Z.prototype=C.fn,Y.uniq=$,Y.deserializeValue=w,C.zepto=Y,C}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(t){function e(t){var e=this.os={},n=this.browser={},i=t.match(/WebKit\/([\d.]+)/),r=t.match(/(Android)\s+([\d.]+)/),s=t.match(/(iPad).*OS\s([\d_]+)/),o=!s&&t.match(/(iPhone\sOS)\s([\d_]+)/),a=t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),c=a&&t.match(/TouchPad/),l=t.match(/Kindle\/([\d.]+)/),u=t.match(/Silk\/([\d._]+)/),h=t.match(/(BlackBerry).*Version\/([\d.]+)/),d=t.match(/(BB10).*Version\/([\d.]+)/),f=t.match(/(RIM\sTablet\sOS)\s([\d.]+)/),p=t.match(/PlayBook/),_=t.match(/Chrome\/([\d.]+)/)||t.match(/CriOS\/([\d.]+)/),m=t.match(/Firefox\/([\d.]+)/);(n.webkit=!!i)&&(n.version=i[1]),r&&(e.android=!0,e.version=r[2]),o&&(e.ios=e.iphone=!0,e.version=o[2].replace(/_/g,".")),s&&(e.ios=e.ipad=!0,e.version=s[2].replace(/_/g,".")),a&&(e.webos=!0,e.version=a[2]),c&&(e.touchpad=!0),h&&(e.blackberry=!0,e.version=h[2]),d&&(e.bb10=!0,e.version=d[2]),f&&(e.rimtabletos=!0,e.version=f[2]),p&&(n.playbook=!0),l&&(e.kindle=!0,e.version=l[1]),u&&(n.silk=!0,n.version=u[1]),!u&&e.android&&t.match(/Kindle Fire/)&&(n.silk=!0),_&&(n.chrome=!0,n.version=_[1]),m&&(n.firefox=!0,n.version=m[1]),e.tablet=!!(s||p||r&&!t.match(/Mobile/)||m&&t.match(/Tablet/)),e.phone=!e.tablet&&!!(r||o||a||h||d||_&&t.match(/Android/)||_&&t.match(/CriOS\/([\d.]+)/)||m&&t.match(/Mobile/))}e.call(t,navigator.userAgent),t.__detect=e}(Zepto),function(t){function e(t){return t._zid||(t._zid=f++)}function n(t,n,s,o){if(n=i(n),n.ns)var a=r(n.ns);return(d[e(t)]||[]).filter(function(t){return!(!t||n.e&&t.e!=n.e||n.ns&&!a.test(t.ns)||s&&e(t.fn)!==e(s)||o&&t.sel!=o)})}function i(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function r(t){return RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function s(e,n,i){"string"!=t.type(e)?t.each(e,i):e.split(/\s/).forEach(function(t){i(t,n)})}function o(t,e){return t.del&&("focus"==t.e||"blur"==t.e)||!!e}function a(t){return _[t]||t}function c(n,r,c,l,u,h){var f=e(n),p=d[f]||(d[f]=[]);s(r,c,function(e,r){var s=i(e);s.fn=r,s.sel=l,s.e in _&&(r=function(e){var n=e.relatedTarget;return!n||n!==this&&!t.contains(this,n)?s.fn.apply(this,arguments):void 0}),s.del=u&&u(r,e);var c=s.del||r;s.proxy=function(t){var e=c.apply(n,[t].concat(t.data));return e===!1&&(t.preventDefault(),t.stopPropagation()),e},s.i=p.length,p.push(s),n.addEventListener(a(s.e),s.proxy,o(s,h))})}function l(t,i,r,c,l){var u=e(t);s(i||"",r,function(e,i){n(t,e,i,c).forEach(function(e){delete d[u][e.i],t.removeEventListener(a(e.e),e.proxy,o(e,l))})})}function u(e){var n,i={originalEvent:e};for(n in e)!g.test(n)&&void 0!==e[n]&&(i[n]=e[n]);return t.each(y,function(t,n){i[t]=function(){return this[n]=m,e[t].apply(e,arguments)},i[n]=v}),i}function h(t){if(!("defaultPrevented"in t)){t.defaultPrevented=!1;var e=t.preventDefault;t.preventDefault=function(){this.defaultPrevented=!0,e.call(this)}}}var d=(t.zepto.qsa,{}),f=1,p={},_={mouseenter:"mouseover",mouseleave:"mouseout"};p.click=p.mousedown=p.mouseup=p.mousemove="MouseEvents",t.event={add:c,remove:l},t.proxy=function(n,i){if(t.isFunction(n)){var r=function(){return n.apply(i,arguments)};return r._zid=e(n),r}if("string"==typeof i)return t.proxy(n[i],n);throw new TypeError("expected function")},t.fn.bind=function(t,e){return this.each(function(){c(this,t,e)})},t.fn.unbind=function(t,e){return this.each(function(){l(this,t,e)})},t.fn.one=function(t,e){return this.each(function(n,i){c(this,t,e,null,function(t,e){return function(){var n=t.apply(i,arguments);return l(i,e,t),n}})})};var m=function(){return!0},v=function(){return!1},g=/^([A-Z]|layer[XY]$)/,y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(e,n,i){return this.each(function(r,s){c(s,n,i,e,function(n){return function(i){var r,o=t(i.target).closest(e,s).get(0);return o?(r=t.extend(u(i),{currentTarget:o,liveFired:s}),n.apply(o,[r].concat([].slice.call(arguments,1)))):void 0}})})},t.fn.undelegate=function(t,e,n){return this.each(function(){l(this,e,n,t)})},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,n,i){return!n||t.isFunction(n)?this.bind(e,n||i):this.delegate(n,e,i)},t.fn.off=function(e,n,i){return!n||t.isFunction(n)?this.unbind(e,n||i):this.undelegate(n,e,i)},t.fn.trigger=function(e,n){return("string"==typeof e||t.isPlainObject(e))&&(e=t.Event(e)),h(e),e.data=n,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(e)})},t.fn.triggerHandler=function(e,i){var r,s;return this.each(function(o,a){r=u("string"==typeof e?t.Event(e):e),r.data=i,r.target=a,t.each(n(a,e.type||e),function(t,e){return s=e.proxy(r),r.isImmediatePropagationStopped()?!1:void 0})}),s},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)}}),["focus","blur"].forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.each(function(){try{this[e]()}catch(t){}}),this}}),t.Event=function(t,e){"string"!=typeof t&&(e=t,t=e.type);var n=document.createEvent(p[t]||"Events"),i=!0;if(e)for(var r in e)"bubbles"==r?i=!!e[r]:n[r]=e[r];return n.initEvent(t,i,!0,null,null,null,null,null,null,null,null,null,null,null,null),n.isDefaultPrevented=function(){return this.defaultPrevented},n}}(Zepto),function(t){function e(e,n,i){var r=t.Event(n);return t(e).trigger(r,i),!r.defaultPrevented}function n(t,n,i,r){return t.global?e(n||g,i,r):void 0}function i(e){e.global&&0===t.active++&&n(e,null,"ajaxStart")}function r(e){e.global&&!--t.active&&n(e,null,"ajaxStop")}function s(t,e){var i=e.context;return e.beforeSend.call(i,t,e)===!1||n(e,i,"ajaxBeforeSend",[t,e])===!1?!1:(n(e,i,"ajaxSend",[t,e]),void 0)}function o(t,e,i){var r=i.context,s="success";i.success.call(r,t,s,e),n(i,r,"ajaxSuccess",[e,i,t]),c(s,e,i)}function a(t,e,i,r){var s=r.context;r.error.call(s,i,e,t),n(r,s,"ajaxError",[i,r,t]),c(e,i,r)}function c(t,e,i){var s=i.context;i.complete.call(s,e,t),n(i,s,"ajaxComplete",[e,i]),r(i)}function l(){}function u(t){return t&&(t=t.split(";",2)[0]),t&&(t==x?"html":t==k?"json":w.test(t)?"script":b.test(t)&&"xml")||"text"}function h(t,e){return(t+"&"+e).replace(/[&?]{1,2}/,"?")}function d(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),e.data&&(!e.type||"GET"==e.type.toUpperCase())&&(e.url=h(e.url,e.data))}function f(e,n,i,r){var s=!t.isFunction(n);return{url:e,data:s?n:void 0,success:s?t.isFunction(i)?i:void 0:n,dataType:s?r||i:i}}function p(e,n,i,r){var s,o=t.isArray(n);t.each(n,function(n,a){s=t.type(a),r&&(n=i?r:r+"["+(o?"":n)+"]"),!r&&o?e.add(a.name,a.value):"array"==s||!i&&"object"==s?p(e,a,i,n):e.add(n,a)})}var _,m,v=0,g=window.document,y=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,w=/^(?:text|application)\/javascript/i,b=/^(?:text|application)\/xml/i,k="application/json",x="text/html",C=/^\s*$/;t.active=0,t.ajaxJSONP=function(e){if("type"in e){var n,i="jsonp"+ ++v,r=g.createElement("script"),c=function(){clearTimeout(n),t(r).remove(),delete window[i]},u=function(t){c(),t&&"timeout"!=t||(window[i]=l),a(null,t||"abort",h,e)},h={abort:u};return s(h,e)===!1?(u("abort"),!1):(window[i]=function(t){c(),o(t,h,e)},r.onerror=function(){u("error")},r.src=e.url.replace(/=\?/,"="+i),t("head").append(r),e.timeout>0&&(n=setTimeout(function(){u("timeout")},e.timeout)),h)}return t.ajax(e)},t.ajaxSettings={type:"GET",beforeSend:l,success:l,error:l,complete:l,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:k,xml:"application/xml, text/xml",html:x,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var n=t.extend({},e||{});for(_ in t.ajaxSettings)void 0===n[_]&&(n[_]=t.ajaxSettings[_]);i(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=""+window.location),d(n),n.cache===!1&&(n.url=h(n.url,"_="+Date.now()));var r=n.dataType,c=/=\?/.test(n.url);if("jsonp"==r||c)return c||(n.url=h(n.url,"callback=?")),t.ajaxJSONP(n);var f,p=n.accepts[r],v={},g=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,y=n.xhr();n.crossDomain||(v["X-Requested-With"]="XMLHttpRequest"),p&&(v.Accept=p,p.indexOf(",")>-1&&(p=p.split(",",2)[0]),y.overrideMimeType&&y.overrideMimeType(p)),(n.contentType||n.contentType!==!1&&n.data&&"GET"!=n.type.toUpperCase())&&(v["Content-Type"]=n.contentType||"application/x-www-form-urlencoded"),n.headers=t.extend(v,n.headers||{}),y.onreadystatechange=function(){if(4==y.readyState){y.onreadystatechange=l,clearTimeout(f);var e,i=!1;if(y.status>=200&&300>y.status||304==y.status||0==y.status&&"file:"==g){r=r||u(y.getResponseHeader("content-type")),e=y.responseText;try{"script"==r?(1,eval)(e):"xml"==r?e=y.responseXML:"json"==r&&(e=C.test(e)?null:t.parseJSON(e))}catch(s){i=s}i?a(i,"parsererror",y,n):o(e,y,n)}else a(null,y.status?"error":"abort",y,n)}};var w="async"in n?n.async:!0;y.open(n.type,n.url,w);for(m in n.headers)y.setRequestHeader(m,n.headers[m]);return s(y,n)===!1?(y.abort(),!1):(n.timeout>0&&(f=setTimeout(function(){y.onreadystatechange=l,y.abort(),a(null,"timeout",y,n)},n.timeout)),y.send(n.data?n.data:null),y)},t.get=function(){return t.ajax(f.apply(null,arguments))},t.post=function(){var e=f.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=f.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,i){if(!this.length)return this;var r,s=this,o=e.split(/\s/),a=f(e,n,i),c=a.success;return o.length>1&&(a.url=o[0],r=o[1]),a.success=function(e){s.html(r?t("<div>").html(e.replace(y,"")).find(r):e),c&&c.apply(s,arguments)},t.ajax(a),this};var T=encodeURIComponent;t.param=function(t,e){var n=[];return n.add=function(t,e){this.push(T(t)+"="+T(e))},p(n,t,e),n.join("&").replace(/%20/g,"+")}}(Zepto),function(t){t.fn.serializeArray=function(){var e,n=[];return t(Array.prototype.slice.call(this.get(0).elements)).each(function(){e=t(this);var i=e.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&("radio"!=i&&"checkbox"!=i||this.checked)&&n.push({name:e.attr("name"),value:e.val()})}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(e)this.bind("submit",e);else if(this.length){var n=t.Event("submit");
this.eq(0).trigger(n),n.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(t,e){function n(t){return i(t.replace(/([a-z])([A-Z])/,"$1-$2"))}function i(t){return t.toLowerCase()}function r(t){return s?s+t:i(t)}var s,o,a,c,l,u,h,d,f="",p={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},_=window.document,m=_.createElement("div"),v=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,g={};t.each(p,function(t,n){return m.style[t+"TransitionProperty"]!==e?(f="-"+i(t)+"-",s=n,!1):void 0}),o=f+"transform",g[a=f+"transition-property"]=g[c=f+"transition-duration"]=g[l=f+"transition-timing-function"]=g[u=f+"animation-name"]=g[h=f+"animation-duration"]=g[d=f+"animation-timing-function"]="",t.fx={off:s===e&&m.style.transitionProperty===e,speeds:{_default:400,fast:200,slow:600},cssPrefix:f,transitionEnd:r("TransitionEnd"),animationEnd:r("AnimationEnd")},t.fn.animate=function(e,n,i,r){return t.isPlainObject(n)&&(i=n.easing,r=n.complete,n=n.duration),n&&(n=("number"==typeof n?n:t.fx.speeds[n]||t.fx.speeds._default)/1e3),this.anim(e,n,i,r)},t.fn.anim=function(i,r,s,f){var p,_,m,y={},w="",b=this,k=t.fx.transitionEnd;if(r===e&&(r=.4),t.fx.off&&(r=0),"string"==typeof i)y[u]=i,y[h]=r+"s",y[d]=s||"linear",k=t.fx.animationEnd;else{_=[];for(p in i)v.test(p)?w+=p+"("+i[p]+") ":(y[p]=i[p],_.push(n(p)));w&&(y[o]=w,_.push(o)),r>0&&"object"==typeof i&&(y[a]=_.join(", "),y[c]=r+"s",y[l]=s||"linear")}return m=function(e){if(e!==void 0){if(e.target!==e.currentTarget)return;t(e.target).unbind(k,m)}t(this).css(g),f&&f.call(this)},r>0&&this.bind(k,m),this.size()&&this.get(0).clientLeft,this.css(y),0>=r&&setTimeout(function(){b.each(function(){m.call(this)})},0),this},m=null}(Zepto),function(){var t=this,e=t._,n={},i=Array.prototype,r=Object.prototype,s=Function.prototype,o=i.push,a=i.slice,c=i.concat,l=r.toString,u=r.hasOwnProperty,h=i.forEach,d=i.map,f=i.reduce,p=i.reduceRight,_=i.filter,m=i.every,v=i.some,g=i.indexOf,y=i.lastIndexOf,w=Array.isArray,b=Object.keys,k=s.bind,x=function(t){return t instanceof x?t:this instanceof x?(this._wrapped=t,void 0):new x(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):t._=x,x.VERSION="1.4.3";var C=x.each=x.forEach=function(t,e,i){if(null!=t)if(h&&t.forEach===h)t.forEach(e,i);else if(t.length===+t.length){for(var r=0,s=t.length;s>r;r++)if(e.call(i,t[r],r,t)===n)return}else for(var o in t)if(x.has(t,o)&&e.call(i,t[o],o,t)===n)return};x.map=x.collect=function(t,e,n){var i=[];return null==t?i:d&&t.map===d?t.map(e,n):(C(t,function(t,r,s){i[i.length]=e.call(n,t,r,s)}),i)};var T="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return i&&(e=x.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(C(t,function(t,s,o){r?n=e.call(i,n,t,s,o):(n=t,r=!0)}),!r)throw new TypeError(T);return n},x.reduceRight=x.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return i&&(e=x.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var s=t.length;if(s!==+s){var o=x.keys(t);s=o.length}if(C(t,function(a,c,l){c=o?o[--s]:--s,r?n=e.call(i,n,t[c],c,l):(n=t[c],r=!0)}),!r)throw new TypeError(T);return n},x.find=x.detect=function(t,e,n){var i;return E(t,function(t,r,s){return e.call(n,t,r,s)?(i=t,!0):void 0}),i},x.filter=x.select=function(t,e,n){var i=[];return null==t?i:_&&t.filter===_?t.filter(e,n):(C(t,function(t,r,s){e.call(n,t,r,s)&&(i[i.length]=t)}),i)},x.reject=function(t,e,n){return x.filter(t,function(t,i,r){return!e.call(n,t,i,r)},n)},x.every=x.all=function(t,e,i){e||(e=x.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,i):(C(t,function(t,s,o){return(r=r&&e.call(i,t,s,o))?void 0:n}),!!r)};var E=x.some=x.any=function(t,e,i){e||(e=x.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,i):(C(t,function(t,s,o){return r||(r=e.call(i,t,s,o))?n:void 0}),!!r)};x.contains=x.include=function(t,e){return null==t?!1:g&&t.indexOf===g?-1!=t.indexOf(e):E(t,function(t){return t===e})},x.invoke=function(t,e){var n=a.call(arguments,2);return x.map(t,function(t){return(x.isFunction(e)?e:t[e]).apply(t,n)})},x.pluck=function(t,e){return x.map(t,function(t){return t[e]})},x.where=function(t,e){return x.isEmpty(e)?[]:x.filter(t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},x.max=function(t,e,n){if(!e&&x.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.max.apply(Math,t);if(!e&&x.isEmpty(t))return-1/0;var i={computed:-1/0,value:-1/0};return C(t,function(t,r,s){var o=e?e.call(n,t,r,s):t;o>=i.computed&&(i={value:t,computed:o})}),i.value},x.min=function(t,e,n){if(!e&&x.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.min.apply(Math,t);if(!e&&x.isEmpty(t))return 1/0;var i={computed:1/0,value:1/0};return C(t,function(t,r,s){var o=e?e.call(n,t,r,s):t;i.computed>o&&(i={value:t,computed:o})}),i.value},x.shuffle=function(t){var e,n=0,i=[];return C(t,function(t){e=x.random(n++),i[n-1]=i[e],i[e]=t}),i};var $=function(t){return x.isFunction(t)?t:function(e){return e[t]}};x.sortBy=function(t,e,n){var i=$(e);return x.pluck(x.map(t,function(t,e,r){return{value:t,index:e,criteria:i.call(n,t,e,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index<e.index?-1:1}),"value")};var S=function(t,e,n,i){var r={},s=$(e||x.identity);return C(t,function(e,o){var a=s.call(n,e,o,t);i(r,a,e)}),r};x.groupBy=function(t,e,n){return S(t,e,n,function(t,e,n){(x.has(t,e)?t[e]:t[e]=[]).push(n)})},x.countBy=function(t,e,n){return S(t,e,n,function(t,e){x.has(t,e)||(t[e]=0),t[e]++})},x.sortedIndex=function(t,e,n,i){n=null==n?x.identity:$(n);for(var r=n.call(i,e),s=0,o=t.length;o>s;){var a=s+o>>>1;r>n.call(i,t[a])?s=a+1:o=a}return s},x.toArray=function(t){return t?x.isArray(t)?a.call(t):t.length===+t.length?x.map(t,x.identity):x.values(t):[]},x.size=function(t){return null==t?0:t.length===+t.length?t.length:x.keys(t).length},x.first=x.head=x.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:a.call(t,0,e)},x.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},x.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},x.rest=x.tail=x.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},x.compact=function(t){return x.filter(t,x.identity)};var M=function(t,e,n){return C(t,function(t){x.isArray(t)?e?o.apply(n,t):M(t,e,n):n.push(t)}),n};x.flatten=function(t,e){return M(t,e,[])},x.without=function(t){return x.difference(t,a.call(arguments,1))},x.uniq=x.unique=function(t,e,n,i){x.isFunction(e)&&(i=n,n=e,e=!1);var r=n?x.map(t,n,i):t,s=[],o=[];return C(r,function(n,i){(e?i&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(t[i]))}),s},x.union=function(){return x.uniq(c.apply(i,arguments))},x.intersection=function(t){var e=a.call(arguments,1);return x.filter(x.uniq(t),function(t){return x.every(e,function(e){return x.indexOf(e,t)>=0})})},x.difference=function(t){var e=c.apply(i,a.call(arguments,1));return x.filter(t,function(t){return!x.contains(e,t)})},x.zip=function(){for(var t=a.call(arguments),e=x.max(x.pluck(t,"length")),n=Array(e),i=0;e>i;i++)n[i]=x.pluck(t,""+i);return n},x.object=function(t,e){if(null==t)return{};for(var n={},i=0,r=t.length;r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},x.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return i=x.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}if(g&&t.indexOf===g)return t.indexOf(e,n);for(;r>i;i++)if(t[i]===e)return i;return-1},x.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(y&&t.lastIndexOf===y)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var r=i?n:t.length;r--;)if(t[r]===e)return r;return-1},x.range=function(t,e,n){1>=arguments.length&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,s=Array(i);i>r;)s[r++]=t,t+=n;return s};var W=function(){};x.bind=function(t,e){var n,i;if(t.bind===k&&k)return k.apply(t,a.call(arguments,1));if(!x.isFunction(t))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(a.call(arguments)));W.prototype=t.prototype;var r=new W;W.prototype=null;var s=t.apply(r,n.concat(a.call(arguments)));return Object(s)===s?s:r}},x.bindAll=function(t){var e=a.call(arguments,1);return 0==e.length&&(e=x.functions(t)),C(e,function(e){t[e]=x.bind(t[e],t)}),t},x.memoize=function(t,e){var n={};return e||(e=x.identity),function(){var i=e.apply(this,arguments);return x.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},x.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},x.defer=function(t){return x.delay.apply(x,[t,1].concat(a.call(arguments,1)))},x.throttle=function(t,e){var n,i,r,s,o=0,a=function(){o=new Date,r=null,s=t.apply(n,i)};return function(){var c=new Date,l=e-(c-o);return n=this,i=arguments,0>=l?(clearTimeout(r),r=null,o=c,s=t.apply(n,i)):r||(r=setTimeout(a,l)),s}},x.debounce=function(t,e,n){var i,r;return function(){var s=this,o=arguments,a=function(){i=null,n||(r=t.apply(s,o))},c=n&&!i;return clearTimeout(i),i=setTimeout(a,e),c&&(r=t.apply(s,o)),r}},x.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},x.wrap=function(t,e){return function(){var n=[t];return o.apply(n,arguments),e.apply(this,n)}},x.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},x.after=function(t,e){return 0>=t?e():function(){return 1>--t?e.apply(this,arguments):void 0}},x.keys=b||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)x.has(t,n)&&(e[e.length]=n);return e},x.values=function(t){var e=[];for(var n in t)x.has(t,n)&&e.push(t[n]);return e},x.pairs=function(t){var e=[];for(var n in t)x.has(t,n)&&e.push([n,t[n]]);return e},x.invert=function(t){var e={};for(var n in t)x.has(t,n)&&(e[t[n]]=n);return e},x.functions=x.methods=function(t){var e=[];for(var n in t)x.isFunction(t[n])&&e.push(n);return e.sort()},x.extend=function(t){return C(a.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},x.pick=function(t){var e={},n=c.apply(i,a.call(arguments,1));return C(n,function(n){n in t&&(e[n]=t[n])}),e},x.omit=function(t){var e={},n=c.apply(i,a.call(arguments,1));for(var r in t)x.contains(n,r)||(e[r]=t[r]);return e},x.defaults=function(t){return C(a.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend({},t):t},x.tap=function(t,e){return e(t),t};var A=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof x&&(t=t._wrapped),e instanceof x&&(e=e._wrapped);var r=l.call(t);if(r!=l.call(e))return!1;switch(r){case"[object String]":return t==e+"";case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=n.length;s--;)if(n[s]==t)return i[s]==e;n.push(t),i.push(e);var o=0,a=!0;if("[object Array]"==r){if(o=t.length,a=o==e.length)for(;o--&&(a=A(t[o],e[o],n,i)););}else{var c=t.constructor,u=e.constructor;if(c!==u&&!(x.isFunction(c)&&c instanceof c&&x.isFunction(u)&&u instanceof u))return!1;for(var h in t)if(x.has(t,h)&&(o++,!(a=x.has(e,h)&&A(t[h],e[h],n,i))))break;if(a){for(h in e)if(x.has(e,h)&&!o--)break;a=!o}}return n.pop(),i.pop(),a};x.isEqual=function(t,e){return A(t,e,[],[])},x.isEmpty=function(t){if(null==t)return!0;if(x.isArray(t)||x.isString(t))return 0===t.length;for(var e in t)if(x.has(t,e))return!1;return!0},x.isElement=function(t){return!(!t||1!==t.nodeType)},x.isArray=w||function(t){return"[object Array]"==l.call(t)},x.isObject=function(t){return t===Object(t)},C(["Arguments","Function","String","Number","Date","RegExp"],function(t){x["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),x.isArguments(arguments)||(x.isArguments=function(t){return!(!t||!x.has(t,"callee"))}),x.isFunction=function(t){return"function"==typeof t},x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},x.isNaN=function(t){return x.isNumber(t)&&t!=+t},x.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},x.isNull=function(t){return null===t},x.isUndefined=function(t){return void 0===t},x.has=function(t,e){return u.call(t,e)},x.noConflict=function(){return t._=e,this},x.identity=function(t){return t},x.times=function(t,e,n){for(var i=Array(t),r=0;t>r;r++)i[r]=e.call(n,r);return i},x.random=function(t,e){return null==e&&(e=t,t=0),t+(0|Math.random()*(e-t+1))};var j={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};j.unescape=x.invert(j.escape);var P={escape:RegExp("["+x.keys(j.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(j.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(t){x[t]=function(e){return null==e?"":(""+e).replace(P[t],function(e){return j[t][e]})}}),x.result=function(t,e){if(null==t)return null;var n=t[e];return x.isFunction(n)?n.call(t):n},x.mixin=function(t){C(x.functions(t),function(e){var n=x[e]=t[e];x.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),I.call(this,n.apply(x,t))}})};var N=0;x.uniqueId=function(t){var e=""+ ++N;return t?t+e:e},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(t,e,n){n=x.defaults({},n,x.templateSettings);var i=RegExp([(n.escape||O).source,(n.interpolate||O).source,(n.evaluate||O).source].join("|")+"|$","g"),r=0,s="__p+='";t.replace(i,function(e,n,i,o,a){return s+=t.slice(r,a).replace(R,function(t){return"\\"+L[t]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(s+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),r=a+e.length,e}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=Function(n.variable||"obj","_",s)}catch(a){throw a.source=s,a}if(e)return o(e,x);var c=function(t){return o.call(this,t,x)};return c.source="function("+(n.variable||"obj")+"){\n"+s+"}",c},x.chain=function(t){return x(t).chain()};var I=function(t){return this._chain?x(t).chain():t};x.mixin(x),C(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];x.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],I.call(this,n)}}),C(["concat","join","slice"],function(t){var e=i[t];x.prototype[t]=function(){return I.call(this,e.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){var t,e=this,n=e.Backbone,i=[],r=i.push,s=i.slice,o=i.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="0.9.10";var a=e._;a||"undefined"==typeof require||(a=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var c=/\s+/,l=function(t,e,n,i){if(!n)return!0;if("object"==typeof n)for(var r in n)t[e].apply(t,[r,n[r]].concat(i));else{if(!c.test(n))return!0;for(var s=n.split(c),o=0,a=s.length;a>o;o++)t[e].apply(t,[s[o]].concat(i))}},u=function(t,e){var n,i=-1,r=t.length;switch(e.length){case 0:for(;r>++i;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;r>++i;)(n=t[i]).callback.call(n.ctx,e[0]);return;case 2:for(;r>++i;)(n=t[i]).callback.call(n.ctx,e[0],e[1]);return;case 3:for(;r>++i;)(n=t[i]).callback.call(n.ctx,e[0],e[1],e[2]);return;default:for(;r>++i;)(n=t[i]).callback.apply(n.ctx,e)}},h=t.Events={on:function(t,e,n){if(!l(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!l(this,"once",t,[e,n])||!e)return this;var i=this,r=a.once(function(){i.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n),this},off:function(t,e,n){var i,r,s,o,c,u,h,d;if(!this._events||!l(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(o=t?[t]:a.keys(this._events),c=0,u=o.length;u>c;c++)if(t=o[c],i=this._events[t]){if(s=[],e||n)for(h=0,d=i.length;d>h;h++)r=i[h],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&s.push(r);this._events[t]=s}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!l(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&u(n,e),i&&u(i,arguments),this},listenTo:function(t,e,n){var i=this._listeners||(this._listeners={}),r=t._listenerId||(t._listenerId=a.uniqueId("l"));return i[r]=t,t.on(e,"object"==typeof e?this:n,this),this},stopListening:function(t,e,n){var i=this._listeners;if(i){if(t)t.off(e,"object"==typeof e?this:n,this),e||n||delete i[t._listenerId];else{"object"==typeof e&&(n=this);for(var r in i)i[r].off(e,n,this);this._listeners={}}return this}}};h.bind=h.on,h.unbind=h.off,a.extend(t,h);var d=t.Model=function(t,e){var n,i=t||{};this.cid=a.uniqueId("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(i=this.parse(i,e)||{}),(n=a.result(this,"defaults"))&&(i=a.defaults({},i,n)),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};a.extend(d.prototype,h,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return a.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return a.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,r,s,o,c,l,u,h;if(null==t)return this;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1;s=n.unset,c=n.silent,o=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=a.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(i in r)e=r[i],a.isEqual(h[i],e)||o.push(i),a.isEqual(u[i],e)?delete this.changed[i]:this.changed[i]=e,s?delete h[i]:h[i]=e;if(!c){o.length&&(this._pending=!0);for(var d=0,f=o.length;f>d;d++)this.trigger("change:"+o[d],this,h[o[d]],n)}if(l)return this;if(!c)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,a.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,a.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!a.isEmpty(this.changed):a.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?a.clone(this.changed):!1;var e,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var r in t)a.isEqual(i[r],e=t[r])||((n||(n={}))[r]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return a.clone(this._previousAttributes)},fetch:function(t){t=t?a.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success;return t.success=function(t,n,i){return t.set(t.parse(n,i),i)?(e&&e(t,n,i),void 0):!1},this.sync("read",this,t)},save:function(t,e,n){var i,r,s,o,c=this.attributes;return null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,!i||n&&n.wait||this.set(i,n)?(n=a.extend({validate:!0},n),this._validate(i,n)?(i&&n.wait&&(this.attributes=a.extend({},c,i)),void 0===n.parse&&(n.parse=!0),r=n.success,n.success=function(t,e,n){t.attributes=c;var s=t.parse(e,n);return n.wait&&(s=a.extend(i||{},s)),a.isObject(s)&&!t.set(s,n)?!1:(r&&r(t,e,n),void 0)},s=this.isNew()?"create":n.patch?"patch":"update","patch"===s&&(n.attrs=i),o=this.sync(s,this,n),i&&n.wait&&(this.attributes=c),o):!1):!1},destroy:function(t){t=t?a.clone(t):{};var e=this,n=t.success,i=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(t,e,r){(r.wait||t.isNew())&&i(),n&&n(t,e,r)},this.isNew())return t.success(this,null,t),!1;var r=this.sync("delete",this,t);return t.wait||i(),r},url:function(){var t=a.result(this,"urlRoot")||a.result(this.collection,"url")||A();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return!this.validate||!this.validate(this.attributes,t)},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=a.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,e||{}),!1):!0}});var f=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,a.extend({silent:!0},e))};a.extend(f.prototype,h,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){t=a.isArray(t)?t.slice():[t],e||(e={});var n,i,s,c,l,u,h,d,f,p;for(h=[],d=e.at,f=this.comparator&&null==d&&0!=e.sort,p=a.isString(this.comparator)?this.comparator:null,n=0,i=t.length;i>n;n++)(s=this._prepareModel(c=t[n],e))?(l=this.get(s))?e.merge&&(l.set(c===s?s.attributes:c,e),f&&!u&&l.hasChanged(p)&&(u=!0)):(h.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)):this.trigger("invalid",this,c,e);if(h.length&&(f&&(u=!0),this.length+=h.length,null!=d?o.apply(this.models,[d,0].concat(h)):r.apply(this.models,h)),u&&this.sort({silent:!0}),e.silent)return this;for(n=0,i=h.length;i>n;n++)(s=h[n]).trigger("add",s,this,e);return u&&this.trigger("sort",this,e),this},remove:function(t,e){t=a.isArray(t)?t.slice():[t],e||(e={});var n,i,r,s;for(n=0,i=t.length;i>n;n++)s=this.get(t[n]),s&&(delete this._byId[s.id],delete this._byId[s.cid],r=this.indexOf(s),this.models.splice(r,1),this.length--,e.silent||(e.index=r,s.trigger("remove",s,this,e)),this._removeReference(s));return this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,a.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,a.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[t.id||t.cid||t[this._idAttr]||t])},at:function(t){return this.models[t]},where:function(t){return a.isEmpty(t)?[]:this.filter(function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},sort:function(t){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return t||(t={}),a.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(a.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return a.invoke(this.models,"get",t)},update:function(t,e){e=a.extend({add:!0,merge:!0,remove:!0},e),e.parse&&(t=this.parse(t,e));var n,i,r,s,o=[],c=[],l={};if(a.isArray(t)||(t=t?[t]:[]),e.add&&!e.remove)return this.add(t,e);for(i=0,r=t.length;r>i;i++)n=t[i],s=this.get(n),e.remove&&s&&(l[s.cid]=!0),(e.add&&!s||e.merge&&s)&&o.push(n);if(e.remove)for(i=0,r=this.models.length;r>i;i++)n=this.models[i],l[n.cid]||c.push(n);return c.length&&this.remove(c,e),o.length&&this.add(o,e),this},reset:function(t,e){e||(e={}),e.parse&&(t=this.parse(t,e));for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return e.previousModels=this.models.slice(),this._reset(),t&&this.add(t,a.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},fetch:function(t){t=t?a.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success;return t.success=function(t,n,i){var r=i.update?"update":"reset";t[r](n,i),e&&e(t,n,i)},this.sync("read",this,t)},create:function(t,e){if(e=e?a.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,i=e.success;return e.success=function(t,e,r){r.wait&&n.add(t,r),i&&i(t,e,r)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var n=new this.model(t,e);return n._validate(t,e)?n:!1},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))},sortedIndex:function(t,e,n){e||(e=this.comparator);var i=a.isFunction(e)?e:function(t){return t.get(e)};return a.sortedIndex(this.models,t,i,n)}});var p=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];a.each(p,function(t){f.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.models),a[t].apply(a,e)}});var _=["groupBy","countBy","sortBy"];a.each(_,function(t){f.prototype[t]=function(e,n){var i=a.isFunction(e)?e:function(t){return t.get(e)};return a[t](this.models,i,n)}});var m=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},v=/\((.*?)\)/g,g=/(\(\?)?:\w+/g,y=/\*\w+/g,w=/[\-{}\[\]+?.,\\\^$|#\s]/g;a.extend(m.prototype,h,{initialize:function(){},route:function(e,n,i){return a.isRegExp(e)||(e=this._routeToRegExp(e)),i||(i=this[n]),t.history.route(e,a.bind(function(r){var s=this._extractParameters(e,r);i&&i.apply(this,s),this.trigger.apply(this,["route:"+n].concat(s)),this.trigger("route",n,s),t.history.trigger("route",this,n,s)},this)),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes)for(var t,e=a.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])},_routeToRegExp:function(t){return t=t.replace(w,"\\$&").replace(v,"(?:$1)?").replace(g,function(t,e){return e?t:"([^/]+)"}).replace(y,"(.*?)"),RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var b=t.History=function(){this.handlers=[],a.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},k=/^[#\/]|\s+$/g,x=/^\/+|\/+$/g,C=/msie [\w.]+/,T=/\/$/;b.started=!1,a.extend(b.prototype,h,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var n=this.root.replace(T,"");t.indexOf(n)||(t=t.substr(n.length))}else t=this.getHash();return t.replace(k,"")},start:function(e){if(b.started)throw Error("Backbone.history has already been started");b.started=!0,this.options=a.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),i=document.documentMode,r=C.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);this.root=("/"+this.root+"/").replace(x,"/"),r&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var s=this.location,o=s.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&s.hash&&(this.fragment=this.getHash().replace(k,""),this.history.replaceState({},document.title,this.root+this.fragment+s.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),b.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=a.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!b.started)return!1;if(e&&e!==!0||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var n=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),t.history=new b;var E=t.View=function(t){this.cid=a.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},$=/^(\S+)\s*(.*)$/,S=["model","collection","el","id","attributes","className","tagName","events"];a.extend(E.prototype,h,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(t||(t=a.result(this,"events"))){this.undelegateEvents();for(var e in t){var n=t[e];if(a.isFunction(n)||(n=this[t[e]]),!n)throw Error('Method "'+t[e]+'" does not exist');var i=e.match($),r=i[1],s=i[2];n=a.bind(n,this),r+=".delegateEvents"+this.cid,""===s?this.$el.on(r,n):this.$el.on(r,s,n)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=a.extend({},a.result(this,"options"),t)),a.extend(this,a.pick(t,S)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(a.result(this,"el"),!1);else{var e=a.extend({},a.result(this,"attributes"));this.id&&(e.id=a.result(this,"id")),this.className&&(e["class"]=a.result(this,"className"));var n=t.$("<"+a.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}});var M={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.sync=function(e,n,i){var r=M[e];a.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});
var s={type:r,dataType:"json"};if(i.url||(s.url=a.result(n,"url")||A()),null!=i.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),i.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",i.emulateJSON&&(s.data._method=r);var o=i.beforeSend;i.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",r),o?o.apply(this,arguments):void 0}}"GET"===s.type||i.emulateJSON||(s.processData=!1);var c=i.success;i.success=function(t){c&&c(n,t,i),n.trigger("sync",n,t,i)};var l=i.error;i.error=function(t){l&&l(n,t,i),n.trigger("error",n,t,i)};var u=i.xhr=t.ajax(a.extend(s,i));return n.trigger("request",n,u,i),u},t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var W=function(t,e){var n,i=this;n=t&&a.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},a.extend(n,i,e);var r=function(){this.constructor=n};return r.prototype=i.prototype,n.prototype=new r,t&&a.extend(n.prototype,t),n.__super__=i.prototype,n};d.extend=f.extend=m.extend=E.extend=b.extend=W;var A=function(){throw Error('A "url" property or function must be specified')}}.call(this),window.JST={"category.container":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/category.container.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<div class="popup"></div>'),__.line=2,__.col=1,__.push('<div id="category-container"></div>')}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},"category.info":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/category.info.blade";try{with(__.locals)__.line=1,__.col=1,servers.length?(__.line=4,__.col=3,__.push('<div class="info no-tracks">No tracks selected, add tracks from a server:'),__.line=5,__.col=5,__.push('<ul class="playlists">'),__.line=6,__.col=7,servers.each(function(t){__.line=7,__.col=9;var e=t.id;__.line=8,__.col=9;var n=t.get("status");__.line=9,__.col=9,__.push("<li"),__.r.attrs({id:{v:e,e:1},"class":{v:n,e:1}},__),__.push(">"),__.line=10,__.col=11,__.push("<a"),__.r.attrs({href:{v:"/directory/"+e+"/0",e:1}},__),__.push(">"),__.line=11,__.col=13,__.push(__.r.escape(t.get("name"))+"</a>"),__.line=12,__.col=11,__.push('<div class="loading">'),__.line=13,__.col=13,__.push("[ loading"),__.line=14,__.col=13,__.push('<i class="icon-refresh icon-spin"></i>'),__.line=15,__.col=13,__.push("]</div></li>")}),__.push("</ul></div>")):(__.line=2,__.col=3,__.push('<div class="info no-server">No upnp media servers detected on the network, add a server to begin</div>'))}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},"category.nav":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/category.nav.blade";try{with(__.locals)__.line=1,__.col=1,__.push("<nav>"),__.line=2,__.col=3,__.push('<a href="/category/Artist" class="active Artist" cat="Artist">Artists</a>'),__.line=3,__.col=3,__.push('<a href="/category/Album" cat="Album" class="Album">Albums</a>'),__.line=4,__.col=3,__.push('<a href="/category/Title" cat="Title" class="Title">Tracks</a></nav>')}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},"category.popup":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/category.popup.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<div class="top-box">'),__.line=2,__.col=3,__.push('<h1 class="play">'),__.line=3,__.col=5,__.push('<i class="icon-play-circle"></i>'),__.line=4,__.col=5,__.push('<span class="divider">| </span>'),__.line=5,__.col=5,__.push('<span class="next">Play Next</span></h1>'),__.line=6,__.col=3,__.push('<h1 class="add"> Add to playlist</h1>'),__.line=7,__.col=3,__.push('<h1 class="new"> Create new playlist</h1></div>'),__.line=8,__.col=1,__.push('<div class="bottom-box add"></div>'),__.line=9,__.col=1,__.push('<div class="bottom-box new">'),__.line=10,__.col=3,__.push("<form>"),__.line=11,__.col=5,__.push('<input type="text" class="name"/>'),__.line=12,__.col=5,__.push('<input type="submit" class="submit"/></form></div>'),__.line=13,__.col=1,__.push('<span class="cancel">cancel</span>')}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},"category.show":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/category.show.blade";try{with(__.locals){__.line=1,__.col=1;var title=model.getTitle();__.line=2,__.col=1;var docs=model.get("docs");__.line=3,__.col=1;var name;__.line=5,__.col=1,title&&(__.line=6,__.col=3,__.push('<span class="title">'),__.line=7,__.col=5,__.push(__.r.escape(title)+"</span>"));var current=jumper&&docs&&docs.length>20?" ":String.fromCharCode(99999);__.line=9,__.col=1,__.push('<div class="category-list">'),__.line=10,__.col=3,__.push("<ul>"),__.line=11,__.col=5,__.r.foreach(__,docs,function(t){__.line=12,__.col=7,name=t.Title||t,__.line=13,__.col=7,name.toUpperCase()[0]>current&&(__.line=14,__.col=9,current=name.toUpperCase()[0],__.line=15,__.col=9,__.push('<li class="jumper"'),__.r.attrs({id:{v:"jumper"+current,e:1}},__),__.push("></li>")),__.line=17,__.col=7,t._id?(__.line=18,__.col=9,__.push("<li"),__.r.attrs({id:{v:t._id,e:1}},__),__.push(">"+__.r.escape(name)+"</li>")):(__.line=20,__.col=9,__.push("<li>"+__.r.escape(name)+"</li>"))}),__.push("</ul></div>")}}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},"directory.container":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/directory.container.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<div class="popup server">'),__.line=2,__.col=3,__.push("<h1>Add tracks from current directory?</h1>"),__.line=3,__.col=3,__.push('<h2 class="ok">ok</h2>'),__.line=4,__.col=3,__.push('<h2 class="cancel">cancel</h2></div>'),__.line=5,__.col=1,__.push('<div id="category-container"></div>')}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},header:function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/header.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<div class="nav-wrap">'),__.line=2,__.col=3,__.push('<span class="menuLink icon-reorder"></span>'),__.line=3,__.col=3,__.push('<div id="subnav"></div></div>')}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},loader:function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/loader.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<div class="icon-spinner icon-spin loader"></div>')}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},menu:function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/menu.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<div class="musicLink">'),__.line=2,__.col=3,__.push('<i class="icon-chevron-left"></i>'),__.line=3,__.col=3,__.push("Music </div>"),__.line=4,__.col=1,__.push('<div class="lists">'),__.line=5,__.col=3,__.push("<h1>Play To</h1>"),__.line=6,__.col=3,__.push('<ul class="renderers">'),__.line=7,__.col=5,renderers.each(function(t){__.line=8,__.col=7;var e=t.get("uuid");__.line=9,__.col=7,__.push("<li"),__.r.attrs({id:{v:e,e:1}},__),__.push(">"),__.line=10,__.col=9,__.push("<span>"),__.line=11,__.col=11,__.push(__.r.escape(t.get("name"))+"</span>"),__.line=12,__.col=9,__.push('<i class="icon-circle"></i></li>')}),__.push("</ul>"),__.line=14,__.col=3,__.push("<h1>Playlists</h1>"),__.line=15,__.col=3,__.push('<ul class="playlists">'),__.line=16,__.col=5,playlists.each(function(t){__.line=17,__.col=7;var e=t.get("_id");__.line=18,__.col=7,__.push("<li"),__.r.attrs({id:{v:e,e:1}},__),__.push(">"),__.line=19,__.col=9,__.push("<a"),__.r.attrs({href:{v:"/playlist/"+e,e:1}},__),__.push(">"),__.line=20,__.col=11,__.push(__.r.escape(t.get("name"))+"</a>"),__.line=21,__.col=9,__.push('<i class="icon-volume-up"></i>'),__.line=22,__.col=9,t.get("uuid")||(__.line=23,__.col=11,__.push('<i class="icon-trash"></i>')),__.push("</li>")}),__.push("</ul>"),__.line=25,__.col=3,__.push("<h1>Servers</h1>"),__.line=26,__.col=3,__.push('<ul class="playlists servers">'),__.line=27,__.col=5,servers.each(function(t){__.line=28,__.col=7;var e=t.id;__.line=29,__.col=7;var n=t.get("status");__.line=30,__.col=7,__.push("<li"),__.r.attrs({id:{v:"ms"+e,e:1},"class":{v:n,e:1}},__),__.push(">"),__.line=31,__.col=9,__.push("<a"),__.r.attrs({href:{v:"/directory/"+e+"/0",e:1}},__),__.push(">"),__.line=32,__.col=11,__.push(__.r.escape(t.get("name"))),__.line=33,__.col=11,__.push('<i class="icon-refresh icon-spin"></i></a></li>')}),__.push("</ul></div>")}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},"player.tab":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/player.tab.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<div class="playing">'),__.line=2,__.col=3,__.push('<a class="title">Now Playing</a>'),__.line=3,__.col=3,__.push('<i class="icon-play play"></i>'),__.line=4,__.col=3,__.push('<i class="icon-chevron-right next"></i>'),__.line=5,__.col=3,__.push('<div class="ball"></div></div>')}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},"playlist.dropdown":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/playlist.dropdown.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<ul class="dropDown closed">'),__.line=2,__.col=3,__.push('<li class="current">'),__.line=3,__.col=5,__.push(__.r.escape(currentList.get("name"))),__.line=4,__.col=5,playlists.length>1&&(__.line=5,__.col=7,__.push('<i class="icon-angle-down down"></i>')),__.push("</li>"),__.line=6,__.col=3,playlists.each(function(t){__.line=7,__.col=5;var e=t.get("_id");__.line=8,__.col=5,e!==currentList.get("_id")&&(__.line=9,__.col=7,__.push('<li class="option">'),__.line=10,__.col=9,__.push("<a"),__.r.attrs({href:{v:"/playlist/"+e,e:1}},__),__.push(">"),__.line=11,__.col=11,__.push(__.r.escape(t.get("name"))+"</a>"+"</li>"))}),__.push("</ul>")}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},popup:function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/popup.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<div class="top-box">'),__.line=2,__.col=3,__.push("<h1>add to now playing</h1>"),__.line=3,__.col=3,__.push("<h1>add to ...</h1>"),__.line=4,__.col=3,__.push("<h1>add to new list</h1>"),__.line=5,__.col=3,__.push("<span>cancel</span></div>"),__.line=6,__.col=1,__.push('<div class="bottom-box"></div>')}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},"server.menu":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/server.menu.blade";try{with(__.locals)__.line=1,__.col=1,__.push('<div class="directory-button refresh">'),__.line=2,__.col=3,__.push('<div class="refresh">'),__.line=3,__.col=5,__.push("Refresh"),__.line=4,__.col=5,__.push('<i class="icon-refresh"></i></div>'),__.line=5,__.col=3,__.push('<div class="load">'),__.line=6,__.col=5,__.push("loading"),__.line=7,__.col=5,__.push('<i class="icon-refresh icon-spin"></i></div></div>')}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)},"track.list":function(locals,cb,__){__=__||[],__.r=__.r||blade.Runtime,__.func||(__.func={},__.blocks={},__.chunk={}),__.locals=locals||{},__.filename="/Users/spurcell/code/fun/node_modules/wu/templates/track.list.blade";try{with(__.locals){__.line=1,__.col=1;var docs=collection.toJSON();__.line=3,__.col=1,__.push('<div class="track-list">'),__.line=4,__.col=3,__.push("<ul>"),__.line=5,__.col=5,__.r.foreach(__,docs,function(t){__.line=6,__.col=7,__.push("<li"),__.r.attrs({id:{v:t._id,e:1},position:{v:t.position,e:1}},__),__.push(">"),__.line=7,__.col=9,__.push('<div class="swipeEl">'),__.line=8,__.col=11,__.push('<div class="track-info">'),__.line=9,__.col=13,__.push('<div class="track-title">'+__.r.escape(t.Title)+"</div>"),__.line=10,__.col=13,__.push('<div class="more">'),__.line=11,__.col=15,__.push(__.r.escape(t.Artist+" - "+t.Album)+"</div>"+"</div>"),__.line=12,__.col=11,__.push('<div class="swipeCover">'),__.line=13,__.col=13,__.push("<h1>Undo</h1></div></div></li>")}),__.push("</ul></div>")}}catch(e){return cb(__.r.rethrow(e,__))}__.inc||__.r.done(__),cb(null,__.join(""),__)}},Wu={Views:{},Models:{},Collections:{},Cache:{Models:{},Views:{},Collections:{}},Routers:{},init:function(){window.Socket=io.connect("/controller"),this.Cache.Models.category=new Wu.Models.category,this.Cache.Models.directory=new Wu.Models.directory,this.Cache.Models.player=new Wu.Models.player,this.Cache.Collections.renderers=new Wu.Collections.renderers,Wu.Cache.Categories=new Wu.Routers.Categories,Wu.Cache.Collections.playlists=new Wu.Collections.playlists,Wu.Cache.Collections.servers=new Wu.Collections.servers,Wu.Cache.Views.toastMaster=new Wu.Views.toastMaster,this.Cache.Collections.servers.reset(bootstrapServers),this.Cache.Collections.renderers.reset(bootstrapRenderers),this.Cache.Collections.playlists.reset(bootstrapPlaylists),$(document).on("click","a:not(.data-bypass)",function(t){t.preventDefault(),Backbone.history.navigate($(t.target).attr("href"),{trigger:!0})}),$(document).on("swipeRight",".category",function(){window.history.back()}),Wu.Layout.init(),Backbone.history.start({pushState:!0})}},window.addEventListener("load",function(){FastClick.attach(document.body)},!1),$(document).ready(function(){window.Wu=Wu,Wu.init()});var Drawer=function(){function t(t){return t.touches?t.touches[0].pageY:t.pageY}function e(t){return t.touches?t.touches[0].pageX:t.pageX}function n(t){var e=t.touches?t.touches[0].pageX:t.pageX,n=t.touches?t.touches[0].pageY:t.pageY,i=e-l.offset().left,r=n-l.offset().top;w&&r>a&&s>r&&o>i&&i>c&&(f=t.timeStamp,d="horizontal"==h.drag?e:n,p=!0)}function i(t){if(p){t.preventDefault();var e=u(t),n=0===d?0:Math.abs(e-d),i=h.maxTime,r=h.maxDistance;if(currentTime=t.timeStamp,0!==f&&i>currentTime-f&&n>r){if(d>e){var s="horizontal"==h.drag?"left":"up";l.trigger(s)}if(e>d){var s="horizontal"==h.drag?"right":"down";l.trigger(s),p=!1}f=0,d=0}}else"full"==_?t.preventDefault():"partial"==_&&(t.overide||t.preventDefault())}function r(){f=0,d=0,p=!1}var s,o,a,c,l,u,h={maxTime:1e3,maxDistance:20,scopeEl:$("html"),xPadding:0,yPadding:0,drag:"horizontal"},d=0,f=0,p=!1,_=!1,m="ontouchend"in document,v=m?"touchstart":"mousedown",g=m?"touchmove":"mousemove",y=m?"touchend":"mouseup",w=!0;return{init:function(d){if($.extend(h,d),l=$(h.el),!l||1>l.length)throw"Error: Need to supply a valid target element";a=h.yPadding,c=h.xPadding,o=l.width()+c,s=l.height()+a,h.scopeEl.on(v,n).on(g,i).on(y,r),u="horizontal"==h.drag?e:t,$(".nots").bind(g,function(t){t.xyz=!0}),l.on("toggleDrag",function(t,e){w=void 0===e?!w:e})},toggle:function(t){p=t},lockScroll:function(t){_=t}}}();Wu.Layout={init:function(){this.header=new Wu.Views.header({el:$("#header")}),this.menu=new Wu.Views.menu({collection:Wu.Cache.Collections.renderers,el:$("#menu")}).render(),this.menu.trigger("inserted"),this.footer=new Wu.Views.playerTab({model:Wu.Cache.Models.player,el:$("#pullTab")}).render(),this.footer.trigger("inserted")},setSubHeader:function(t){this.header.setSubHeader(t),this.header.render()},removeSubHeader:function(){this.header.removeSubHeader()},setPage:function(t){this.page&&this.page.unrender(),this.menu.hide(),$("#mask").hide(),$("#page").html(t.render().$el),t.trigger("inserted"),this.page=t}},function(t){function e(t,e,n){function i(){var n=e.blocks;e.blocks={};var i=s.capture(e,e.length,t());return e.blocks=n,i}return n?i():h.isolate(i)}function n(t,e,n){n&&(t.filename=e.filename,t.source=e.source),t.line=e.line,t.col=e.col}function i(t,e,n){var i=t.buf.splice(n,t.buf.length-n);Array.prototype.unshift.apply(t.buf,i);for(var r in e.blocks)e.blocks[r].parent==t&&e.blocks[r].pos>=n&&(e.blocks[r].pos-=n)}function r(t,e){for(var n=t+" ",i=0;e-n.length+1>i;i++)n=" "+n;return n}var s="object"==typeof exports?exports:{},o={},a={},c=function(t,e){return e},l=function(t){return t()},u=function(t,e){return e()},h={attachEvents:c,setDataContext:c,isolate:l,render:l,list:function(t,e,n){var i=[];if(t.observe({added:function(t){i.push(t)}}).stop(),!i.length)return n();for(var r="",s=0;i.length>s;s++)r+=e(i[s]);return r},labelBranch:u,createLandmark:u,finalize:c};s.options={mount:"/views/",loadTimeout:15e3},(s.client="undefined"!=typeof window)&&(window.blade={Runtime:s,LiveUpdate:h,_cachedViews:o,_cb:{},runtime:s}),s.escape=function(t){return null==t?"":new String(t).replace(/&(?!([a-zA-Z]+|(#[0-9]+)|(#[xX][0-9a-fA-F]+));)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},s.attrs=function(t,e){for(var n in t){var i=t[n];if(null==i.v||i.v===!1){if(null==i.a)continue;i.v=i.a,delete i.a}i.v===!0&&(i.v=n),"class"==n&&(i.v instanceof Array&&(i.v=i.v.join(" ")),i.a&&(i.v=(i.v.length>0?i.v+" ":"")+i.a)),i.e?e.push(" "+n+'="'+s.escape(i.v)+'"'):e.push(" "+n+'="'+i.v+'"')}},s.ueid=s.client?1e3:0,s.bind=function(t,e,n,i,r){for(var s="",o=t.split(" "),c=0;o.length>c;c++)s=","+o[c]+" #"+e;a[s.substr(1)]=n;var l="i["+JSON.stringify(t)+"]="+(""+n);if(r){var c=i.length-1;i[c]=i[c].substr(0,i[c].length-3)+";"+l+"-->"}else i.push("<!--"+l+"-->")},s.trigger=t,s.loadTemplate=function(t,e,n,i){function r(t,n){for(var i=0;t.length>i;i++)n?t[i](n):t[i](null,o[e])}function a(t){var n=c._cb[e].cb;delete c._cb[e],l.parentNode.removeChild(l),r(n,Error("Blade Template ["+e+"] could not be loaded: "+(t?t:"Request timed out")))}if("function"==typeof n&&(i=n,"object"==typeof e?(n=e,e=t,t=""):n=null),"function"==typeof e&&(i=e,e=t,n=null,t=""),0>e.split("/").pop().indexOf(".")&&(e+=".blade"),s.client){if(e=s.resolve(e),o[e])return i(null,o[e]),!0;var c=window.blade;if(c._cb[e])c._cb[e].cb.push(i);else{var l=document.createElement("script");l.type="text/javascript",l.async=!0,l.src=s.options.mount+e;var u=setTimeout(a,s.options.loadTimeout),h=c._cb[e]=function(i,o){if(clearTimeout(u),delete c._cb[e],l.parentNode.removeChild(l),o.length>0)for(var a=0,d=0;o.length>d;d++)s.loadTemplate(t,i+"/"+o[d],n,function(t){return t?r(h.cb,t):(++a==o.length&&r(h.cb),void 0)});else r(h.cb)};h.cb=[i];var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(l,d),l.onload=l.onreadystatechange=l.onerror=function(){var t=this.readyState;t&&"loaded"!=t&&"complete"!=t||!c._cb[e]||(clearTimeout(u),a("Request failed"))}}return!1}return n.synchronous=!0,require("./blade").compileFile(t+"/"+e,n,function(t,e){return t?i(t):(i(null,e.template),void 0)}),!0},s.resolve=function(t){if(s.client){var e=document.createElement("div");e.innerHTML='<a href="'+s.escape("./"+t)+'"></a>',e=e.firstChild.href;var n=window.location.href.split("#")[0];return e=e.substr(n.substr(0,n.lastIndexOf("/")).length).replace(/\/[\/]+/g,"/"),"/"==e.charAt(0)&&(e=e.substr(1)),e}},s.include=function(t,e){var n=e.inc,i=e.base,r=e.rel,o=e.filename,a=e.line,c=e.col,l=e.source,u=e.locals;if(e.inc=!0,arguments.length>2){e.locals={};for(var d=2;arguments.length>d;d+=2)e.locals[arguments[d]]=arguments[d+1]}var f=s.loadTemplate(e.base,e.rel+"/"+t,s.compileOptions,function(d,f){if(d)throw d;var p=e.length;f(e.locals,function(d,f){if(d)throw d;e.inc=n,e.base=i,e.rel=r,e.filename=o,e.line=a,e.col=c,e.source=l,e.locals=u,e.bd||(f=s.capture(e,p),e.push(h.labelBranch(e.filename+":"+e.line+":inc:"+t,function(){return f})))},e)});if(!f)throw Error("Included file ["+e.rel+"/"+t+"] could not be loaded synchronously!")},s.func=function(t,e,n){var i=n.func[t]=e;i.filename=n.filename,i.source=n.source},s.call=function(t,e,n){var i=n.func[t],r=[n];if(null==i)throw Error("Function '"+t+"' is undefined.");for(var s=3;arguments.length>s;s++)r[s-2]=arguments[s];var o=n.filename,a=n.source;n.filename=i.filename,n.source=i.source,i.apply(e,r),n.filename=o,n.source=a},s.capture=function(t,e){for(var n in t.blocks){var i=t.blocks[n];i.pos>=e&&(!t.block||i.parent==t.block)&&(null==i.parent?t[i.pos]=i.buf.join(""):(i.parent.buf[i.pos]=i.buf.join(""),i.parent.numChildren--),delete t.blocks[n])}return t.splice(e,t.length-e).join("")},s.chunk=function(t,e,n){n.chunk[t]=function(){return s.capture(n,n.length,e.apply(this,arguments))}},s.isolate=function(t,n){n.push(e(t,n))},s.constant=function(t,e,n){n.push(h.labelBranch(n.filename+":"+t,function(){return h.createLandmark({constant:!0},function(){return s.capture(n,n.length,e())})}))},s.preserve=function(t,e,n,i){i.push(h.labelBranch(i.filename+":"+t,function(){return h.createLandmark({preserve:e},function(){return s.capture(i,i.length,n())})}))},s.foreach=function(t,n,i,r){function s(n){var r=n._id||("string"==typeof n?n:null)||h.UNIQUE_LABEL;return h.labelBranch(r,function(){return e(function(){return i.call(n,n)},t,a)})}function o(){return h.labelBranch("else",function(){return r?e(r,t,a):""})}var a=!1;if(n&&"observe"in n)t.push(h.list(n,s,o));else{a=!0;var c="",l=1;for(var u in n)l=0,c+=s(n[u]);t.push(l?o():c)}},s.blockDef=function(t,e,i){var r=e.blocks[t]={parent:e.block||null,buf:[],pos:e.length,numChildren:0},s=["r","blocks","func","locals","cb","base","rel","filename","source"];for(var o in s)r.buf[s[o]]=e[s[o]];if(r.buf.block=r,r.parent&&r.parent.numChildren++,e.push(""),i.length>1)r.paramBlock=i;else try{i(r.buf)}catch(a){throw n(e,r.buf),a}},s.blockRender=function(t,e,r){var s=r.blocks[e];if(null==s)throw Error("Block '"+e+"' is undefined.");if(null==s.paramBlock)throw Error("Block '"+e+"' is a regular, non-parameterized block, which cannot be rendered.");for(var o=[s.buf],a=3;arguments.length>a;a++)o[a-2]=arguments[a];"r"==t&&(s.buf.length=0);var c=s.buf.length;try{s.paramBlock.apply(this,o)}catch(l){throw n(r,s.buf,1),l}"p"==t&&i(s,r,c)},s.blockMod=function(t,e,r,s){var o=r.blocks[e];if(null==o)throw Error("Block '"+e+"' is undefined.");"r"==t&&(delete o.paramBlock,o.buf.length=0);var a=o.buf.length;if(s.length>1)o.paramBlock=s;else try{o.buf.rel=r.rel,o.buf.base=r.base,s(o.buf)}catch(c){throw n(r,o.buf),c}"p"==t&&i(o,r,a)},s.done=function(t){for(var e=!1;!e;){e=!0;for(var n in t.blocks){var i=t.blocks[n];i.done||0!=i.numChildren||(e=!1,null==i.parent?t[i.pos]=i.buf.join(""):(i.parent.buf[i.pos]=i.buf.join(""),i.parent.numChildren--),i.done=!0)}}t.eventHandlers=a,a={},s.client||(s.ueid=0)},s.rethrow=function(t,e){if(null==e&&(e=t),t.lastFilename==e.filename&&null!=t.lastFilename)return t;e.column=e.column||e.col;var n=t.message+"\n    at "+(null==e.filename?"<anonymous>":e.filename)+(null==e.line?"":":"+e.line+(null==e.column?"":":"+e.column));if(null!=e.source){var i=3,s=e.source.split("\n"),o=Math.max(e.line-i,0),a=Math.min(e.line+i,s.length),c=new String(a).length;s=s.slice(o,a),n+="\n\n";for(var l=0;s.length>l;l++)n+=r(l+o+1,c)+(l+o+1==e.line?">	":"|	")+s[l]+"\n"}return t.message=n,t.lastFilename=e.filename,null==t.filename&&null==t.line&&(t.filename=e.filename,t.line=e.line,t.column=e.column),t}}(function(e,t){var r=e.previousSibling,i={},h,n;eval(r.textContent),e.parentNode.removeChild(r);for(r in i)for(h=r.split(" "),n=0;h.length>n;n++)e["on"+h[n]]=i[r];return e["on"+t[0].type].apply(e,t)}),function(t){function e(t){return"tagName"in t?t:t.parentNode}function n(t,e,n,i){var r=Math.abs(t-e),s=Math.abs(n-i);return r>=s?t-e>0?"Left":"Right":n-i>0?"Up":"Down"}function i(){l=null,u.last&&(u.el.trigger("longTap"),u={})}function r(){l&&clearTimeout(l),l=null}function s(){o&&clearTimeout(o),a&&clearTimeout(a),c&&clearTimeout(c),l&&clearTimeout(l),o=a=c=l=null,u={}}var o,a,c,l,u={},h=750;t(document).ready(function(){var d,f;t(document.body).bind("touchstart",function(n){d=Date.now(),f=d-(u.last||d),u.el=t(e(n.touches[0].target)),o&&clearTimeout(o),u.x1=n.touches[0].pageX,u.y1=n.touches[0].pageY,f>0&&250>=f&&(u.isDoubleTap=!0),u.last=d,l=setTimeout(i,h)}).bind("touchmove",function(t){r(),u.x2=t.touches[0].pageX,u.y2=t.touches[0].pageY,Math.abs(u.x1-u.x2)>10&&t.preventDefault()}).bind("touchend",function(){r(),u.x2&&Math.abs(u.x1-u.x2)>30||u.y2&&Math.abs(u.y1-u.y2)>30?c=setTimeout(function(){u.el.trigger("swipe"),u.el.trigger("swipe"+n(u.x1,u.x2,u.y1,u.y2)),u={}},0):"last"in u&&(a=setTimeout(function(){var e=t.Event("tap");e.cancelTouch=s,u.el.trigger(e),u.isDoubleTap?(u.el.trigger("doubleTap"),u={}):o=setTimeout(function(){o=null,u.el.trigger("singleTap"),u={}},250)},0))}).bind("touchcancel",s),t(window).bind("scroll",s)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(e){t.fn[e]=function(t){return this.bind(e,t)}})}(Zepto),Wu.Views.list=Backbone.View.extend({template:JST["category.show"],initialize:function(t){if(t&&t.noJumper||(this.jumper=new Wu.Views.listJumper({list:this.$el,el:$("#alphabet")}),this.$el.on("click",".jumper",$.proxy(this.jumper.show,this.jumper))),t&&t.loader){var e=this;JST.loader({},function(t,n){e.loaderHTML=n}),this.listenTo(this.model,"request",function(){this.$(".loader").show(),$("#mask").show()})}},render:function(){var t=this;return this.template({model:this.model,jumper:this.jumper},function(e,n){$("#mask").hide(),t.$el.html(n),t.jumper&&t.jumper.render(),t.loaderHTML&&t.$el.append(t.loaderHTML);var i=t.$(".title")[0]||t.$("li")[0];i&&i.scrollIntoView()}),this},unrender:function(){this.stopListening(),this.jumper&&this.jumper.unrender()}}),Wu.Views.categories=Backbone.View.extend({template:JST["category.container"],initialize:function(){this.list=new Wu.Views.categoryList({model:this.model,className:"category",parent:this}),this.popup=new Wu.Views.categoryPopup({collection:Wu.Cache.Collections.playlists,model:this.model,className:"popup"}),this.listenTo(this.model,"change:id",function(){this.model.fetch()}),this.listenTo(this.list,"showPopup",function(){this.popup.show()}),this.listenTo(this.list,"rendered",function(){this.popup.hide()}),this.listenTo(this,"tracksInserted",this.tracksInserted)},render:function(){var t=this;return this.template({},function(e,n){t.$el.html(n).append(t.popup.render().$el),t.$("#category-container").html(t.list.render().$el)}),this},unrender:function(){this.stopListening(),this.list.unrender()},tracksInserted:function(){this.model.fetch()}}),Wu.Views.categoryList=Wu.Views.list.extend({ORDER:["Artist","Album","Title"],infoTemplate:JST["category.info"],events:{"click .category-list li:not(.jumper)":"select","click .title":"showPopup"},initialize:function(t){Wu.Views.list.prototype.initialize.call(this,t),t.url?this.url=t.url:(this.url="category/",this.isCategory=!0),this.listenTo(this.model,"change:docs",this.render),this.isCategory&&(this.listenTo(Wu.Cache.Collections.servers,"add remove",function(){this.isCategory&&!Wu.Cache.Collections.servers.tracksInserted&&this.render()}),this.listenTo(Wu.Cache.Collections.servers,"change:tracksInserted",this.render))},render:function(){var t=this;return this.model.get("docs"),!this.isCategory||Wu.Cache.Collections.servers.tracksInserted?(Wu.Views.list.prototype.render.call(this),$("#mask").hide(),this.trigger("rendered")):this.infoTemplate({servers:Wu.Cache.Collections.servers},function(e,n){t.$el.html(n),$("#mask").show()}),this},unrender:function(){Wu.Views.list.prototype.unrender.call(this),this.$el.off(),this.stopListening()},select:function(t){var e=this.model.filter($(t.target).text(),t.target.id);e?Backbone.history.navigate(this.url+e,{trigger:!0}):this.trigger("showPopup")},showPopup:function(t){t.preventDefault(),this.trigger("showPopup")}}),Wu.Views.categoriesNav=Backbone.View.extend({template:JST["category.nav"],initialize:function(){this.listenTo(this.model,"change:id",this.updateActive)},render:function(){var t=this;return this.template({},function(e,n){t.$el.html(n),t.updateActive({},t.model.get("id"))}),this},unrender:function(){this.stopListening()},updateActive:function(t,e){this.$(".active").removeClass("active"),this.$("."+e).addClass("active")}}),Wu.Views.categoryPopup=Backbone.View.extend({template:JST["category.popup"],events:{"click h1.play i":"playNow","click h1.play .next":"playNext","click h1.add":"showAddTo","click h1.new":"showCreate","click span.new":"showCreate","click .cancel":"back","submit .bottom-box.new form":"createList","click .bottom-box.add li":"addToList"},render:function(){var t=this;return this.template({},function(e,n){t.$el.html(n),t.setHeight()}),this},unrender:function(){var t=this.model.get("filter");t&&delete t._id,$("#mask").off("click",$.proxy(this.hide,this))},setHeight:function(){var t=$(window).height()-Math.round(.11*$(window).height())-100;t=Math.min(500,t),this.$(".bottom-box").css("max-height",t)},generateList:function(){if(this.collection.length){var t="<ul>";this.collection.each(function(e){t+="<li listId='"+e.get("_id")+"'>"+e.get("name")+"</li>"}),t+="</ul>"}else var t="No exisiting playlists, <span class='new'>create one</span> to continue";return t},showAddTo:function(){this.$el.addClass("add expand"),this.collection.fetch({success:$.proxy(function(){this.$(".bottom-box.add").html(this.generateList())},this)})},showCreate:function(){this.$el.removeClass("add").addClass("new expand"),this.$("input.name").val("")},back:function(){this.$el.hasClass("expand")?this.$el.removeClass("new add expand"):this.hide()},show:function(){$("#mask").show(),$("#mask").on("click",$.proxy(this.hide,this)),this.$el.show()},hide:function(){$("#mask").hide(),$("#mask").off("click",$.proxy(this.hide,this)),this.$el.hide(),this.$el.removeClass("new add expand");var t=this.model.get("filter");t&&delete t._id},createList:function(t){t.preventDefault();var e=this.$(".bottom-box.new .name")[0].value;if(""==e)alert("please enter a name");else{var n=new Wu.Models.playlist({name:e}),i=this.model.get("filter");n.set("filter",i),n.save(null,{success:$.proxy(function(t){var n='Playlist "'+e+'" created with '+t.get("added")+" tracks";this.collection.add(t),Wu.Cache.Views.toastMaster.message(n)},this),error:function(t,e){var n=e.responseText;Wu.Cache.Views.toastMaster.error(n)}}),n.set("filter",!1),this.hide()}},playNow:function(){var t=Wu.Cache.Models.player.get("quickList"),e=this.collection.get(t);return e?(e.set("clearAfter",0),this._add(e,function(){Socket.emit("playPlaylist",t)}),void 0):(Wu.Cache.Views.toastMaster.error("Must select a media renderer first"),void 0)},playNext:function(){var t=Wu.Cache.Models.player,e=t.get("quickList"),n=this.collection.get(e),i=t.get("currentPlayingTrack"),r=(t.get("playlist"),i?i.position:0);return n?(n.set("clearAfter",r),this._add(n),void 0):(Wu.Cache.Views.toastMaster.error("Must select a media renderer first"),void 0)
},addToList:function(t){var e=$(t.target).attr("listId"),n=this.collection.get(e);this._add(n)},_add:function(t,e){var n=this.model.get("filter");t.set("filter",n),t.save(null,{success:function(n){var i=n.get("added")+' tracks added to "'+t.get("name")+'" playlist';Wu.Cache.Views.toastMaster.message(i),"function"==typeof e&&e()},error:function(t,e){var n=e.responseText;Wu.Cache.Views.toastMaster.error(n)}}),t.unset("filter"),t.unset("clearAfter"),this.hide()}}),Wu.Views.directories=Backbone.View.extend({template:JST["directory.container"],events:{"click .popup .ok":"chooseDirectory","click .popup .cancel":"hidePrompt"},initialize:function(){this.list=new Wu.Views.categoryList({model:this.model,className:"category directory",url:"directory/",noJumper:!0,loader:!0,parent:this}),this.listenTo(this.model,"change:id",function(){this.model.fetch({error:function(t,e){Wu.Cache.Views.toastMaster.error(e.responseText),window.history.back()}})}),this.listenTo(this.list,"showPopup",this.showPrompt)},render:function(){var t=this;return this.template({},function(e,n){t.$el.html(n),t.$("#category-container").html(t.list.render().$el)}),this},unrender:function(){this.stopListening(),this.list.unrender()},showPrompt:function(){$("#mask").show(),this.$(".popup").show()},hidePrompt:function(){$("#mask").hide(),this.$(".popup").hide()},chooseDirectory:function(){var t,e=this.model.get("uuid"),n=this.model.get("id"),i=Wu.Cache.Collections.servers.get(e),r=this.model.getTitle();i&&(t=i.get("name"),i.save({path:n},{success:function(){Wu.Cache.Views.toastMaster.message('Adding tracks in "'+r+'" from "'+t+'"')},error:function(t){Wu.Cache.Views.toastMaster.error(t.responseText)}}),Backbone.history.navigate("/",{trigger:!0}))}}),Wu.Views.directoryMenu=Backbone.View.extend({template:JST["server.menu"],events:{"click .refresh":"reloadTracks"},initialize:function(){this.changeServer(),this.listenTo(this.model,"change:uuid",this.changeServer),this.listenTo(Wu.Cache.Collections.servers,"change:status",this.updateButtons)},render:function(){var t=this;return this.template({},function(e,n){t.$el.html(n)}),this},unrender:function(){this.stopListening()},changeServer:function(){var t=this.model.get("uuid");this.server=Wu.Cache.Collections.servers.get(t),this.updateButtons()},updateButtons:function(){var t=this.server&&this.server.get("status");t?"loading"===t?(this.$el.show(),this.$(".refresh").addClass("loading")):"inserted"===t&&(this.$el.show(),this.$(".refresh").removeClass("loading")):this.$el.hide()},reloadTracks:function(){if(this.server){var t=this.server.get("name");this.server.save({},{success:function(){Wu.Cache.Views.toastMaster.message("Refreshing track from "+t)},error:function(t){Wu.Cache.Views.toastMaster.error(t.responseText)}})}}}),Wu.Views.header=Backbone.View.extend({template:JST.header,events:{"click .menuLink":"toggleMenu"},initialize:function(){var t=this;this.template({},function(e,n){t.$el.html(n)})},render:function(){return this.subHeader&&this.subHeader.render(),this},unrender:function(){this.subHeader&&this.subHeader.unrender()},setSubHeader:function(t){this.subHeader&&this.subHeader.unrender(),this.subHeader=t,this.$("#subnav").html(this.subHeader.render().$el)},removeSubHeader:function(){this.subHeader&&(this.subHeader.unrender(),this.subHeader.remove())},toggleMenu:function(){this.trigger("menuClick")}}),Wu.Views.listJumper=Backbone.View.extend({events:{"click .back":"hide","click span.active":"jump"},initialize:function(t){this.$listEl=$(t.list),this.secret=Math.random()},render:function(){return this.$el.html(this.setupJumper()),this},unrender:function(){this.$el.off(),$("#mask").off("click",$.proxy(this.hide,this))},setupJumper:function(){for(var t,e="<div class='back icon-chevron-left'></div>",n=65;91>n;n++)t=String.fromCharCode(n),e+=this.$listEl.find("#jumper"+t).length>0?'<span class="active">'+t+"</span>":'<span class="greyed">'+t+"</span>";return e},jump:function(t){console.log(this.secret);var e=$(t.target).html();this.$listEl.find("#jumper"+e)[0].scrollIntoView(),this.hide()},show:function(){this.$el.addClass("flipOut"),$("#mask").on("click",$.proxy(this.hide,this)),$("#mask").show()},hide:function(){this.$el.removeClass("flipOut"),$("#mask").off("click",$.proxy(this.hide,this)),$("#mask").hide()}}),Wu.Views.menu=Backbone.View.extend({template:JST.menu,events:{"click .renderers li":"setRenderer","click .musicLink":"gotoMusic","click .playlists li .icon-trash":"deleteList"},initialize:function(){this.listenTo(Wu.Layout.header,"menuClick",this.show),this.listenTo(this.collection,"add remove reset",this.render),this.listenTo(Wu.Cache.Collections.servers,"add remove reset",this.render),this.listenTo(Wu.Cache.Collections.playlists,"add remove reset",this.render),this.listenTo(this,"hideMusic",this.hideMusic),this.listenTo(this,"showMusic",this.showMusic),this.listenTo(Wu.Cache.Models.player,"change:id",this.setActive),this.listenTo(Wu.Cache.Models.player,"change:playlist",this.setActive),this.listenTo(Wu.Cache.Models.player,"change:TransportState",this.setActive),this.listenTo(Wu.Cache.Collections.servers,"change:status",this.setStatus),this.$el.on("click","a",$.proxy(this.hide,this))},render:function(){var t=this;return this.template({playlists:Wu.Cache.Collections.playlists,renderers:this.collection,servers:Wu.Cache.Collections.servers},function(e,n){t.$el.html(n),t.showMusicLink&&t.showMusic(),t.setActive()}),this},unrender:function(){$("#mask").off("click",$.proxy(this.hide,this)),this.stopListening()},deleteList:function(t){var e=$(t.currentTarget).parent().attr("id"),n=Wu.Cache.Collections.playlists,i=n.get(e);i&&i.destroy()},show:function(){this.$el.removeClass("hide"),$("#mask").show().on("click",$.proxy(this.hide,this))},hide:function(){this.$el.addClass("hide"),$("#mask").hide().off("click",$.proxy(this.hide,this))},setRenderer:function(t){var e=$(t.currentTarget).attr("id");Wu.Cache.Models.player.setRenderer(e),this.hide()},hideMusic:function(){this.$(".musicLink").hide(),this.showMusicLink=!1},showMusic:function(){this.$(".musicLink").show(),this.showMusicLink=!0},gotoMusic:function(){var t=Wu.Cache.Models.category.get("id")||"Artist";this.hide(),Backbone.history.navigate("/category/"+t,{trigger:!0})},setStatus:function(t,e){$("#ms"+t.id).removeClass("loading").addClass(e)},setActive:function(){var t=Wu.Cache.Models.player.id,e=Wu.Cache.Models.player.get("playlist"),n="PLAYING"===Wu.Cache.Models.player.get("TransportState");this.$("li").removeClass("active"),e&&$("#"+e)[n?"addClass":"removeClass"]("active"),t&&$("#"+t).addClass("active")}}),Wu.Views.playerTab=Backbone.View.extend({template:JST["player.tab"],events:{"click .icon-play":"play","click .icon-pause":"pause","click .next":"next","mousedown .ball":"dragStart","touchstart .ball":"dragStart"},initialize:function(){this.listenTo(this.model,"change:currentPlayingTrack",this.changeTrack),this.listenTo(this.model,"change:TransportState",this.changePlayState),this.listenTo(this,"inserted",this.setupDrag),this.lastTime=Date.now(),this.animator=this.animateProgress.bind(this),this.animateProgress(),this.listenTo($(document),"mousemove touchmove",$.proxy(this.drag,this)),this.listenTo($(document),"mouseup touchend",$.proxy(this.dragEnd,this)),this.listenTo(this.$el,"mousedown",function(t){t.preventDefault()}),this.listenTo($(window),"resize",$.proxy(function(){this.width=this.$el.width()-50},this)),this.animate=!0},render:function(){var t=this;return this.template({model:this.model},function(e,n){t.$el.html(n),t.changeTrack(t.model,t.model.get("currentPlayingTrack")),t.changePlayState(t.model,t.model.get("TransportState")),t.setPosition(t.model.get("trackPosition"))}),this},unrender:function(){this.stopListening()},animateProgress:function(){if(this.animate&&!this.dragging&&"PLAYING"===this.model.get("TransportState")){var t=this.model.get("trackPosition");this.setPosition(t),this.model.set("trackPosition",t+Date.now()-this.lastTime)}this.lastTime=Date.now(),window.requestAnimationFrame(this.animator)},setPosition:function(t){var e=this.width*(t/this.model.get("duration"));this.$(".ball").css("-webkit-transform","translate3d("+e+"px,0,0)")},dragStart:function(t){this.dragging=!0,t.preventDefault()},drag:function(t){if(this.dragging){var e=t.pageX||t.touches[0].pageX;this.lastX=e,this.$(".ball").css("-webkit-transform","translateZ(0) translateX("+e+"px)")}},dragEnd:function(){if(this.dragging){var t=this.lastX/this.width*this.model.get("duration");Socket.emit("setPosition",t)}this.dragging=!1,this.animate=!1;var e=this;setTimeout(function(){e.animate=!0},1e3)},setupDrag:function(){var t=this;this.width=this.$el.width()-50,Drawer.init({el:this.$el}),this.$el.on("left",function(){t.$el.css("left","0%")}),this.$el.on("right",function(){t.dragging||t.$el.css("left","100%")})},play:function(){Socket.emit("play")},pause:function(){Socket.emit("pause")},next:function(){Socket.emit("next")},changeTrack:function(t,e){var n=e&&e.Title?e.Title:"Unknown";this.$(".title").html(n).attr("href","/playlist/"+t.get("playlist"))},changePlayState:function(t,e){"PLAYING"===e?(this.$(".ball").show(),this.$(".play").removeClass("icon-play").addClass("icon-pause")):(this.$(".ball")["PAUSED_PLAYBACK"===e?"show":"hide"](),this.$(".play").removeClass("icon-pause").addClass("icon-play"))}}),Wu.Views.playlistDropdown=Backbone.View.extend({template:JST["playlist.dropdown"],events:{"click .opened .current":"hide","click .current":"show"},render:function(){var t=this;return this.template({currentList:this.model,playlists:Wu.Cache.Collections.playlists},function(e,n){t.$el.html(n)}),this},unrender:function(){$("#mask").off("click",$.proxy(this.hide,this)),this.stopListening()},show:function(t){$("#mask").show(),$("#mask").on("click",$.proxy(this.hide,this)),this.$(".dropDown").addClass("opened"),this.$(".down").removeClass("icon-angle-down").addClass("icon-angle-up"),t.stopImmediatePropagation()},hide:function(t){$("#mask").hide(),$("#mask").off("click",$.proxy(this.hide,this)),this.$(".dropDown").removeClass("opened"),this.$(".down").removeClass("icon-angle-up").addClass("icon-angle-down"),t.stopImmediatePropagation()}}),Wu.Views.toastMaster=Backbone.View.extend({initialize:function(){this.listenTo(Wu.Cache.Collections.renderers,"add",function(t){this.message('New media renderer "'+t.get("name")+'" detected')},this),this.listenTo(Wu.Cache.Collections.renderers,"remove",function(t){this.message('Media renderer "'+t.get("name")+'" removed')},this),this.listenTo(Wu.Cache.Collections.servers,"add",function(t){this.message('New media server "'+t.get("name")+'" detected')},this),this.listenTo(Wu.Cache.Collections.servers,"remove",function(t){this.message('Media server "'+t.get("name")+'" removed')},this),this.listenTo(Wu.Cache.Models.player,"change:currentPlayingTrack",function(t,e){e&&this.title(e.Title)},this),this.listenTo(Wu.Cache.Models.player,"change:uuid",function(t,e){var n=Wu.Cache.Collections.renderers.get(e);n?this.message('Now playing to "'+n.get("name")+'" renderer'):this.message("No media renderer selected")},this),Socket.on("error",$.proxy(function(t){this.error(t)},this)),Socket.on("tracksInserted",$.proxy(function(){this.message("New tracks inserted")},this)),this.messageStack=[]},title:function(t){window.clearTimeout(this.titleTimeout),$("title").html(t),this.titleTimeout=window.setTimeout(function(){$("title").html("Wu")},4e3)},message:function(t){this.messageStack.push({text:t,type:"message"}),this._show()},error:function(t){this.messageStack.push({text:t,type:"error"}),this._show()},_add:function(t){this.messageStack.push(t),$(".toast").html(t),$(".toast-wrap").show(),window.setTimeout(function(){$(".toast-wrap").hide()},4e3)},_show:function(){if("none"===$(".toast-wrap").css("display")&&this.messageStack.length){var t=this.messageStack.shift();$(".toast-wrap")["error"===t.type?"addClass":"removeClass"]("error").show(),$(".toast").html(t.text),window.setTimeout($.proxy(function(){$(".toast-wrap").hide(),this._show()},this),4e3)}}}),Wu.Views.trackList=Backbone.View.extend({template:JST["track.list"],events:{"click .track-info":"play"},initialize:function(){this.listenTo(Wu.Cache.Models.player,"change:currentPlayingTrack",this.highlight),this.listenTo(this,"inserted",this.highlight),this.listenTo(this,"swipeAway",this.delete),Wu.Mixin.mix(this,Wu.Mixin.swipeAway)},render:function(){var t=this;return this.template({collection:this.collection},function(e,n){t.$el.html(n),t.$("li").length&&t.$("li")[0].scrollIntoView()}),this},unrender:function(){this.stopListening()},highlight:function(){var t=Wu.Cache.Models.player.get("currentPlayingTrack"),e=t?t._id:!1;this.$("li").removeClass("active"),$("#"+e).addClass("active")},play:function(t){if(!$(t.currentTarget).parent().hasClass("transition")){var e=$(t.currentTarget).parent().parent().attr("position");Wu.Cache.Models.player.playByPosition(e,this.model.get("_id"))}},"delete":function(t){var e=this.collection.get(t.attr("position"));e&&e.destroy({error:function(t,e){var n=e.responseText;Wu.Cache.Views.toastMaster.error(n)}})}}),Wu.Models.category=Backbone.Model.extend({ORDER:["Artist","Album","Title"],urlRoot:"/api/categories",initialize:function(){Socket.on("tracksInserted",function(){Wu.Layout.page.trigger("tracksInserted")})},fetch:function(t){var e=this.get("filter");t=t||{},t.data=_.extend({},t.data,{filter:e}),Backbone.Model.prototype.fetch.call(this,t)},filter:function(t,e){var n=this.get("filter")||{},i=this.get("id"),r=_.indexOf(this.ORDER,i);return r++,this.ORDER.length>r?(n[i]=t,this.set("filter",n)):"Title"===i&&(n._id=e),this.ORDER[r]},setCategory:function(t){var e=this.get("filter")||{},n=this.get("id"),i=_.indexOf(this.ORDER,n);for(newIndex=_.indexOf(this.ORDER,t);i>=newIndex;)e[this.ORDER[i]]&&delete e[this.ORDER[i]],i--;e._id&&delete e._id,this.set("filter",e),this.set("id",t)},getTitle:function(){for(var t=this.get("filter")||{},e=this.get("id"),n=_.indexOf(this.ORDER,e);--n>=0;)if(t[this.ORDER[n]])return t[this.ORDER[n]];return!1}}),Wu.Models.directory=Backbone.Model.extend({urlRoot:function(){return"/api/directory/"+this.get("uuid")+"/"},initialize:function(){this.titleMap={}},filter:function(t,e){return e?(this.titleMap[e]=t,this.get("uuid")+"/"+e):!1},getTitle:function(){return this.titleMap[this.get("id")]}}),Wu.Models.player=Backbone.Model.extend({urlRoot:"/api/renderers",idAttribute:"uuid",initialize:function(){var t=this;Socket.on("stateChange",function(e){t.set(e.name,e.value)}),Socket.on("setRendererResult",function(e,n){e?(Wu.Cache.Views.toastMaster.error(e),t.clear()):(t.set("uuid",n),t.fetch())}),Socket.on("rendererRemoved",function(e){t.get("uuid")===e.uuid&&t.clear()})},playByPosition:function(t,e){Socket.emit("playByPosition",t,e)},setRenderer:function(t){Socket.emit("setRenderer",t)}}),Wu.Models.playlist=Backbone.Model.extend({urlRoot:"/api/playlists",idAttribute:"_id"}),Wu.Models.renderer=Backbone.Model.extend({idAttribute:"uuid",urlRoot:"/api/renderers"}),Wu.Models.server=Backbone.Model.extend({idAttribute:"uuid",urlRoot:"/api/servers"}),Wu.Models.tracks=Backbone.Model.extend({idAttribute:"position"}),Wu.Collections.playlists=Backbone.Collection.extend({initialize:function(){Socket.on("rendererAdded",$.proxy(function(){this.fetch()},this)),Socket.on("rendererRemoved",$.proxy(function(){this.fetch()},this))},model:Wu.Models.playlist,url:"/api/playlists"}),Wu.Collections.renderers=Backbone.Collection.extend({model:Wu.Models.renderer,url:"/api/renderers",initialize:function(){var t=this;Socket.on("rendererAdded",function(e){t.add(e)}),Socket.on("rendererRemoved",function(e){var n=t.get(e.uuid);t.remove(n)})}}),Wu.Collections.servers=Backbone.Collection.extend({model:Wu.Models.server,url:"/api/servers",setTracks:function(t){this.tracksInserted!=t&&(this.tracksInserted=t,this.trigger("change:tracksInserted"))},initialize:function(){var t=this;Socket.on("serverAdded",function(e){"inserted"===e.status&&t.setTracks(!0),t.add(e)}),Socket.on("serverRemoved",function(e){t.remove(this.get(e.uuid))}),this.on("reset",function(){t.each(function(e){"inserted"===e.get("status")&&t.setTracks(!0)})}),Socket.on("tracksInserted",function(e){console.log("tracksInserted",e);var n=t.get(e);n&&n.set("status","inserted"),t.setTracks(!0)}),this.hasTracks=!1}}),Wu.Collections.tracks=Backbone.Collection.extend({model:Wu.Models.tracks,initialize:function(t){this._id=t.id},url:function(){return"/api/playlists/"+this._id}}),Wu.Routers.Categories=Backbone.Router.extend({routes:{"":"index","category/:id":"show","playlist/:id":"showList","directory/:uuid/:id":"showDir"},index:function(){this.show("Artist")},show:function(t){var e=Wu.Cache.Models.category;if(e.setCategory(t),"categories"!=Wu.Layout.state){var n=new Wu.Views.categoriesNav({model:e}),i=new Wu.Views.categories({model:e});Wu.Layout.menu.trigger("hideMusic"),e.fetch({success:function(){Wu.Layout.setSubHeader(n),Wu.Layout.setPage(i),Wu.Layout.state="categories"},error:function(){Wu.Cache.Views.toastMaster.error("failed to get category")}})}},showList:function(t){var e,n=Wu.Cache.Collections.playlists.get(t);n?(e=n.get("tracks")||n.set("tracks",new Wu.Collections.tracks({id:t})).get("tracks"),Wu.Layout.state="playlist",Wu.Layout.menu.trigger("showMusic"),e.fetch({success:function(){var t=new Wu.Views.playlistDropdown({model:n}),i=new Wu.Views.trackList({model:n,collection:e,className:"category"});Wu.Layout.setSubHeader(t),Wu.Layout.setPage(i)},error:function(t,e){Wu.Cache.Views.toastMaster.error(e.responseText)}})):Wu.Cache.Views.toastMaster.error("Playlist not found")},showDir:function(t,e){var n=Wu.Cache.Models.directory.get("uuid");if("directory"!=Wu.Layout.state){var i=new Wu.Views.directoryMenu({model:Wu.Cache.Models.directory}),r=new Wu.Views.directories({model:Wu.Cache.Models.directory});Wu.Layout.setSubHeader(i),Wu.Layout.setPage(r),Wu.Layout.state="directory"}Wu.Layout.menu.trigger("showMusic"),Wu.Cache.Models.directory.set("uuid",t),n!=t?(Wu.Cache.Models.directory.set({id:e},{silent:!0}),Wu.Cache.Models.directory.trigger("change:id")):Wu.Cache.Models.directory.set({id:e})}}),function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;e.length>n&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelRequestAnimationFrame=window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),i=Math.max(0,16-(n-t)),r=window.setTimeout(function(){e(n+i)},i);return t=n+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),Wu.Mixin={mix:function(t,e){for(var n,i="_mixin",r=0,s=[];t[i+r];)r++;e.mixID=i+r,t[i]=e,e.view=t,n=_.isFunction(e.events)?e.events():e.events||{},_.each(n,function(n,i){if(!_.isFunction(e[n]))return console.log(n+" is not a function"),void 0;var r=i.split(/\b/);t.$el.on(r[0],r.slice(1).join(""),$.proxy(e[n],e))}),_.extend(t.events,{},s)}},Wu.Mixin.swipeAway={touchable:"ontouchstart"in document.documentElement,events:function(){return map={},map=this.touchable?{"touchstart .swipeEl":"start","touchmove  .swipeEl":"move","touchend   .swipeEl":"end"}:{"mousedown .swipeEl":"start","mousemove .swipeEl":"move","mouseout  .swipeEl":"end","mouseup   .swipeEl":"end"},map["webkitTransitionEnd .swipeEl"]="transitionEnd",map["transitionend .swipeEl"]="transitionEnd",map["click .swipeEl h1"]="undo",map},position:function(t){return t.touches?t.touches[0].pageX:t.pageX},start:function(t){this.cover=$(t.currentTarget).find(".swipeCover"),$(t.currentTarget).hasClass("transition")||(this.active=!0,this.startX=this.position(t),this.pos=0,this.touchable||t.preventDefault())},move:function(t){if(this.active){var e=this.position(t);this.pos=Math.min(0,e-this.startX),(-5>this.pos||this.started)&&(this.cover.css("-webkit-transform","translate3d("+this.pos+"px,0,0)"),this.started=!0)}},end:function(){this.active&&this.started&&(-40>this.pos?(this.cover.parent().addClass("transition"),this.cover.css("-webkit-transform","translate3d(-"+this.cover.width()+"px,0,0)")):0>this.pos&&(this.cover.parent().addClass("transition"),this.cover.css("-webkit-transform","translate3d(0,0,0)"))),this.active=!1,this.started=!1},transitionEnd:function(t){-1!=t.propertyName.indexOf("transform")?"translate3d(0px, 0px, 0px)"===$(t.target).css(t.propertyName)?$(t.currentTarget).removeClass("transition"):$(t.currentTarget).css("opacity",0):"opacity"==t.propertyName&&($(t.currentTarget).parent().hide(),this.view.trigger("swipeAway",$(t.currentTarget).parent()))},undo:function(t){t.preventDefault(),$(t.currentTarget).parent().css("-webkit-transform","translate3d(0,0,0)").parent().removeClass("transition").css("opacity",1)}};